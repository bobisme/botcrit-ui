{"id":"bd-11k","title":"Expanding a thread should jump scroll to 50% down the view","description":"When a thread is expanded (e.g. pressing Enter/Space on a thread anchor), the diff scroll should jump so that the expanded thread starts approximately 50% down the visible diff view area. Currently the thread expands in-place without adjusting scroll position, which can leave the thread off-screen or at the very edge.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-30T21:23:29.809307606Z","created_by":"bob","updated_at":"2026-01-30T22:40:42.068936518Z","closed_at":"2026-01-30T22:40:42.068902043Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-12v","title":"Not all comments are showing","description":"~/src/botty cr-klwd has 7 threads for src/main.rs, but the last three threads don't appear in the UI:\n- th-cwn4\n- th-8bit\n- th-krxi\n\nplease investigate why","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-31T16:11:11.301362082Z","created_by":"bob","updated_at":"2026-02-03T02:17:35.428096563Z","closed_at":"2026-02-03T02:17:30.166886197Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-12v","depends_on_id":"bd-2d2","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-12v","depends_on_id":"bd-3pk","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":1,"issue_id":"bd-12v","author":"Bob","text":"Orphaned threads (th-cwn4, th-8bit, th-krxi) are now rendering and navigable via n/p in all 4 view mode combos (unified, unified+wrap, SBS, SBS+wrap). Two follow-up bugs filed: bd-3pk (threads duplicated in two locations) and bd-2d2 (orphaned threads need to show at their actual file lines with context, not just at the bottom of the section). Keeping this open until both are resolved.","created_at":"2026-01-31T20:25:34Z"},{"id":2,"issue_id":"bd-12v","author":"Bob","text":"Blocked on bd-3pk (duplicate anchored/orphaned threads); bd-2d2 resolved.","created_at":"2026-02-02T16:33:13Z"},{"id":3,"issue_id":"bd-12v","author":"Bob","text":"Verified: all 6 threads for src/main.rs in cr-klwd now render correctly. th-cwn4, th-8bit, th-krxi (the original missing orphaned threads) all display with context and comment blocks. Both blockers (bd-3pk duplicate fix, bd-2d2 orphaned context) were resolved in prior sessions. Closing.","created_at":"2026-02-03T02:17:35Z"}]}
{"id":"bd-12z","title":"Review list: block header showing 'Reviews for <path>'","description":"Change the 1-line 'Reviews' header to use the same block component as the review detail title header. Should display 'Reviews for <dir-path>' where dir-path is the repo path.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T19:20:59.377992311Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T19:48:35.839691321Z","closed_at":"2026-02-11T19:48:35.839672646Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":32,"issue_id":"bd-12z","author":"botcrit-ui-dev","text":"Design decided: Extract reusable draw_block() to components.rs. Block = margin + padding+bar + content + padding+bar + margin. Use for 'Reviews for <path>' header. Same component the diff view blocks will migrate to later.","created_at":"2026-02-11T19:37:57Z"}]}
{"id":"bd-13z","title":"diff pane scrolls past end of content","description":"Scrolling down (j) in the diff pane allows scrolling far past the end of content, leaving a blank screen. The scroll position should clamp so the last line of content stays visible.\n\nAcceptance criteria:\n- Scrolling stops when the bottom of the content reaches the viewport\n- Last line of content should remain visible at maximum scroll (no blank screen below)\n- Works correctly in all 4 view modes (unified/SBS x wrap/no-wrap)\n- Works for both diff-with-threads and file-content-only sections\n\nTesting: Open any review with multiple files. Scroll to the bottom of the diff pane with repeated j presses. Verify the scroll stops at content end. Toggle view modes (v) and wrap (w), re-test each.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-31T23:31:36.290202079Z","created_by":"bob","updated_at":"2026-01-31T23:57:28.452668579Z","closed_at":"2026-01-31T23:57:27.693221830Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":4,"issue_id":"bd-13z","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"},{"id":5,"issue_id":"bd-13z","author":"Bob","text":"Fixed: added clamp_diff_scroll that computes max scroll from stream layout total_lines minus visible height. Called from all 4 downward scroll handlers.","created_at":"2026-01-31T23:57:28Z"}]}
{"id":"bd-14m","title":"Theme selection modal","description":"Add a dedicated theme selection modal/command that shows all available themes and lets the user pick one. Should be triggered from the command palette as a command. The modal should show theme names with the current theme highlighted.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:28:14.000813360Z","created_by":"bob","updated_at":"2026-01-30T16:38:19.467540638Z","closed_at":"2026-01-30T16:38:19.467514069Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-14m","depends_on_id":"bd-31i","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-14m","depends_on_id":"bd-irx","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-155","title":"Change file selected icon","description":"Use ◉ for selected file indicator instead of ▸ in the sidebar.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T17:56:31.424561827Z","created_by":"bob","updated_at":"2026-01-29T18:08:04.533461039Z","closed_at":"2026-01-29T18:08:04.533431634Z","close_reason":"duplicate of bd-3kl","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-16g","title":"file indicator inaccurate with diff wrap on","description":"When scrolling diffs with wrapping enabled, the block at the top showing the current file becomes inaccurate.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:25:27.120232761Z","created_by":"bob","updated_at":"2026-01-30T21:39:35.142828416Z","closed_at":"2026-01-30T21:39:35.142743437Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-17h","title":"show review descriptions","description":"Show review descriptions in the UI.\n\n## Phase 1: Description in review detail view\n- Add description as a styled block at the top of the diff stream (before files)\n- Style like a comment block but distinguished (maybe different bar color or header)\n- Only show if description exists and is non-empty\n\n## Phase 2: Smart title bar\n- When scroll position is at top (description visible): show review title in title bar\n- When scrolled past description to a file: show filename in title bar (current behavior)\n- Requires tracking whether we've scrolled past the description block\n\n## Phase 3 (optional): Description in review list\n- Requires adding description to ReviewSummary (crit CLI change) or separate fetch\n- Show truncated description as 2nd line in list item\n- Lower priority - detail view is more important\n\n## Testing\nUse demo mode (runs without --path) which has description: \"Demo review description\"\n\n## Files likely affected\n- src/stream.rs - add description to stream layout\n- src/view/diff/mod.rs - render description block\n- src/view/review_detail.rs - title bar logic\n- src/model.rs - maybe track scroll-past-description state","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-03T14:51:39.362859111Z","created_by":"bob","updated_at":"2026-02-03T17:29:35.584940540Z","closed_at":"2026-02-03T17:29:35.584911946Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-183","title":"Review list redraw glitch","description":"Review selection list layout redraws incorrectly when scrolling; investigate and fix rendering/scroll logic.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-28T20:38:07.761229878Z","created_by":"bob","updated_at":"2026-01-28T20:47:12.739227538Z","closed_at":"2026-01-28T20:47:12.739188314Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-19x","title":"Preview theme on highlight, revert on esc","description":"When navigating the theme picker, preview each theme as the selection highlight moves. On esc, revert to the previously selected theme. On enter, confirm the selection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:42:59.105971394Z","created_by":"bob","updated_at":"2026-01-30T18:34:48.335053137Z","closed_at":"2026-01-30T18:34:48.334981452Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-19x","depends_on_id":"bd-z91","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1at","title":"Thread header metadata","description":"Threads should show thread id left in darker text and file+line range right in darker text.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T18:04:04.023392279Z","created_by":"bob","updated_at":"2026-01-28T18:16:30.520109911Z","closed_at":"2026-01-28T18:16:30.520091617Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1b8","title":"Add #[must_use] to public functions","description":"Remove #![allow(clippy::must_use_candidate)] by adding #[must_use] attributes.\n\nFocus on:\n- Public functions that return values the caller should use\n- Builder/constructor methods\n- Functions where ignoring the return value is likely a bug\n\nSkip functions where ignoring the result is legitimate (e.g., fire-and-forget updates).","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-03T13:15:39.479591700Z","created_by":"bob","updated_at":"2026-02-11T01:03:51.565909906Z","closed_at":"2026-02-11T01:03:51.565882675Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1bo","title":"show \"crit-ui vX.Y.Z\" bottom left in reviews list view","description":"- 2 horizontal spaces of margin, like hotkey bar\n- 1 vertical lines of margin, like hotkey bar","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-11T20:10:06.728226585Z","created_by":"bob","updated_at":"2026-02-11T20:16:32.480955426Z","closed_at":"2026-02-11T20:16:32.480928786Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-1bs","title":"\"Reviews for <path\" should replace home dir with \"~\" if present","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-11T20:12:33.871826516Z","created_by":"bob","updated_at":"2026-02-11T20:18:54.647291520Z","closed_at":"2026-02-11T20:18:54.647265191Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-1c3","title":"Add # Errors sections to fallible functions","description":"Remove #![allow(clippy::missing_errors_doc)] by documenting error conditions.\n\nFor each pub fn returning Result:\n- Add `# Errors` section to doc comment\n- List conditions that cause errors\n- Reference error types where applicable\n\nFocus on public API functions first.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-02-03T13:15:43.672488723Z","created_by":"bob","updated_at":"2026-02-11T01:13:43.711656442Z","closed_at":"2026-02-11T01:13:43.711631926Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1cx","title":"In-TUI multi-line comment editor","description":"Replace $EDITOR with an inline multi-line text editor for writing comments without leaving the TUI.\n\nRequirements:\n- Multi-line text input with line wrapping\n- Standard text editing: cursor movement, word-level operations (ctrl+w, ctrl+u, etc.)\n- Enter for newlines, submit via ctrl+Enter or similar\n- Esc to cancel\n- Syntax-aware would be nice but not required\n- Should appear as an overlay or panel within the diff view\n\nWhen implemented:\n- a triggers the in-TUI editor (default)\n- A (shift+a) opens $EDITOR (preserved for power users / long comments)\n\nThis is a post-beta enhancement. The $EDITOR flow (bd-37q.3) ships first.","status":"closed","priority":3,"issue_type":"feature","owner":"botcrit-ui-dev","created_at":"2026-02-11T22:29:50.895222080Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-12T01:12:54.820988315Z","closed_at":"2026-02-12T01:12:54.820970522Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["future","ux"],"dependencies":[{"issue_id":"bd-1cx","depends_on_id":"bd-37q.3","type":"blocks","created_at":"2026-02-11T22:29:54.322084834Z","created_by":"botcrit-ui-dev","metadata":"{}","thread_id":""}]}
{"id":"bd-1e4","title":"Diff pane full width","description":"Diff view should expand to the full right edge (no unused right margin), per images/full-width.png.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T17:58:56.931565979Z","created_by":"bob","updated_at":"2026-01-29T18:18:14.233553542Z","closed_at":"2026-01-29T18:18:14.233522884Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1fc","title":"comment input modal position hides lines being commented on","description":"as it is, adding a comment pops up a modal editor and dims everything else.\nthis is a really cool effect, but it obscures the lines being commented on which the writer might need to reference while writing a comment.\n\nlet's change it so when the comment modal opens:\n- the dim is much less significant\n- we leave only the lines being commented on undimmed -- if this is complex, skip\n- we pin the comment box to the bottom of the diff view instead of roughly vertically centered like it is","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-14T15:53:29.846498639Z","created_by":"bob","updated_at":"2026-02-14T22:27:45.837709066Z","closed_at":"2026-02-14T22:27:45.837670694Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["comment","design"]}
{"id":"bd-1fm","title":"Update CLAUDE.md for crit v0.10.0 output flags","description":"Update CLAUDE.md guidance to reflect crit v0.10.0 output format flags and JSON context details.\n\nAcceptance:\n- CLAUDE.md references --format json/text/toon\n- Note that JSON output includes file context and --path is preferred for scripts","status":"closed","priority":4,"issue_type":"task","created_at":"2026-02-02T04:18:28.327415755Z","created_by":"bob","updated_at":"2026-02-02T04:18:54.813229696Z","closed_at":"2026-02-02T04:18:54.813206072Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":6,"issue_id":"bd-1fm","author":"Bob","text":"CLAUDE.md already reflects crit v0.10.0 output format guidance (format flags + JSON context). No changes needed.","created_at":"2026-02-02T04:18:50Z"}]}
{"id":"bd-1fr","title":"Sticky current-file header block","description":"Add a pinned current-file header rendered as a full block (vertical bar, 1 row padding inside, 1 row margin above/below). As scroll advances, upcoming file header replaces the pinned block when it reaches the top.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T16:03:19.678933050Z","created_by":"bob","updated_at":"2026-01-28T16:45:01.515787637Z","closed_at":"2026-01-28T16:45:01.515758673Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1fx","title":"Review Detail screen with file sidebar","description":"Implement review detail view with file sidebar and diff pane layout","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-27T16:15:33.497126608Z","created_by":"bob","updated_at":"2026-01-27T17:13:55.179977437Z","closed_at":"2026-01-27T17:13:55.179949324Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1gm","title":"Modal component","description":"Reusable modal overlay component matching the design spec in notes/modal-design.txt. No border, dimmed background, title+esc header row, search field with placeholder, categorized list items with bullet indicators for active state, proper spacing throughout.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T16:03:59.285184484Z","created_by":"bob","updated_at":"2026-01-30T16:14:36.858872021Z","closed_at":"2026-01-30T16:14:36.858849168Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1gm.1","title":"Dim background overlay","description":"When the modal is open, fill the entire screen behind it with a semi-transparent dimmed overlay. This makes the modal stand out from the content underneath.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:04:03.009395738Z","created_by":"bob","updated_at":"2026-01-30T16:14:33.704528230Z","closed_at":"2026-01-30T16:14:33.704500578Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1gm.1","depends_on_id":"bd-1gm","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1gm.2","title":"Borderless modal with correct vertical layout","description":"Remove box border from modal. Implement vertical layout per spec: 1 blank row, title (bold left) + 'esc' (dim right), 1 blank row, search placeholder ('Search' dim text), 2 blank rows, list items, 2 blank rows.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:04:07.897342812Z","created_by":"bob","updated_at":"2026-01-30T16:14:33.714814008Z","closed_at":"2026-01-30T16:14:33.714799601Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1gm.2","depends_on_id":"bd-1gm","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1gm.3","title":"Selection row horizontal layout with bullet indicator","description":"Implement horizontal layout per spec: 1 space, highlighted area start, 1 space, bullet (●) if currently toggled item else blank, 1 space, item content (title left + extra info right dim), 3 spaces, highlighted area end, 1 space.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:04:12.765824991Z","created_by":"bob","updated_at":"2026-01-30T16:14:33.715276845Z","closed_at":"2026-01-30T16:14:33.715263119Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1gm.3","depends_on_id":"bd-1gm","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1gm.4","title":"Category headers in modal list","description":"Support categorized items in the modal list. Category headers are bold with primary accent color, not selectable. Only show categories if filter matches items in that category. Categories after the first are preceded by a single blank row.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:04:18.022564800Z","created_by":"bob","updated_at":"2026-01-30T16:14:33.715744120Z","closed_at":"2026-01-30T16:14:33.715730574Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1gm.4","depends_on_id":"bd-1gm","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1io","title":"Toggle file sidebar visibility","description":"Add a keybinding (s or f) to hide/show the file sidebar in review detail view. Should work alongside existing focus logic.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T12:32:44.631030094Z","created_by":"bob","updated_at":"2026-01-28T12:43:14.032614373Z","closed_at":"2026-01-28T12:43:14.032578496Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1lv","title":"bug: threads sharing same end line are dropped from comment_map","description":"comment_map is HashMap<usize, &ThreadAnchor> keyed by comment_after_line. When multiple threads end on the same line (e.g. th-eoie 1586-1610 and th-pa12 1589-1610 in cr-hdox), the later insert overwrites the earlier one. Same issue in anchor_map and sbs_comment_map. Fix: use Vec<&ThreadAnchor> as value type so multiple threads can share a display position.","status":"closed","priority":1,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:54:27.861007011Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T18:46:16.932419796Z","closed_at":"2026-02-11T18:46:16.932393888Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1m3","title":"sidebar design changes","description":"- change header\n  - from \"cr-xxxx\" -> \"cr-xxxx · status\" -- bullet should be dim, status should be \"approved/merged/abandoned/whatever\" and should be the same colors we use in the review list\n- if the review has a title:\n  - add a blank line\n  - show the review title, bright, non-bold, word wrap lines\n- change the commit id line\n  - instead of \"<change-id>\"\n  - show \"change-id  commit-id\", both in the brief form (first 8 chars)\n  - jj has an algorithm to highlight the first unique n chars, if we can do that, we should -- not a priority: change id highlight is reddish, commit id highlight is blueish\n","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-15T20:52:34.274960418Z","created_by":"bob","updated_at":"2026-02-15T22:03:42.360633736Z","closed_at":"2026-02-15T22:03:42.360603790Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-1mb","title":"Wrap comment text in thread bubbles","description":"Comments in diff thread bubbles should soft-wrap to the bubble width instead of truncating or overflowing.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T12:46:25.796497114Z","created_by":"bob","updated_at":"2026-01-28T12:49:21.630417895Z","closed_at":"2026-01-28T12:49:21.630393559Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1s5","title":"Stream all file diffs in right pane","description":"Render a continuous stream of file header blocks + diffs + thread blocks in the right pane; no file selection required to view diffs. Upcoming file headers appear inline above their diffs.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T16:03:17.594356353Z","created_by":"bob","updated_at":"2026-01-28T16:45:00.733903245Z","closed_at":"2026-01-28T16:45:00.733873369Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1tj","title":"Sidebar selection highlight only when focused","description":"Only show file list background highlight when the sidebar is focused so focus is clearer.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T17:56:16.020904152Z","created_by":"bob","updated_at":"2026-01-29T18:08:01.910428272Z","closed_at":"2026-01-29T18:08:01.910390611Z","close_reason":"duplicate of bd-3kl","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1u1","title":"Mouse support","description":"Add mouse support: scroll wheel for diff/list, click to select files and reviews.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-28T20:38:02.331022591Z","created_by":"bob","updated_at":"2026-02-02T16:33:30.210623821Z","closed_at":"2026-02-02T16:32:55.069367953Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":7,"issue_id":"bd-1u1","author":"Bob","text":"All child tasks (bd-1u1.1/.2/.3) completed; epic closed.","created_at":"2026-02-02T16:33:30Z"}]}
{"id":"bd-1u1.1","title":"Scroll wheel support in diff and review list","description":"Enable mouse events in opentui. Map scroll wheel up/down to ScrollUp/ScrollDown in the diff pane and ListUp/ListDown in the review list.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T22:41:34.710008821Z","created_by":"bob","updated_at":"2026-02-01T23:30:21.835519112Z","closed_at":"2026-02-01T23:30:21.835484818Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-1u1.1","depends_on_id":"bd-1u1","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1u1.2","title":"Click to select files in sidebar","description":"Map mouse click events in the sidebar area to SelectFile messages. Calculate which file entry was clicked based on y-coordinate relative to sidebar layout.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T22:41:34.750603944Z","created_by":"bob","updated_at":"2026-02-01T23:02:17.532791694Z","closed_at":"2026-02-01T23:02:17.532759233Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-1u1.2","depends_on_id":"bd-1u1","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1u1.3","title":"Click to select reviews in list","description":"Map mouse click events in the review list to SelectReview messages. Calculate which review was clicked based on y-coordinate and scroll offset.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T22:41:34.790412072Z","created_by":"bob","updated_at":"2026-02-01T19:54:06.720806599Z","closed_at":"2026-02-01T19:54:06.720781602Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-1u1.3","depends_on_id":"bd-1u1","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1v0","title":"Hide cursor during navigation","description":"Cursor flashes/moves around when scrolling. Hide cursor unless editing text.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T19:59:14.802903943Z","created_by":"bob","updated_at":"2026-01-29T20:53:57.733406153Z","closed_at":"2026-01-29T20:53:57.733377149Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1vi","title":"Update opentui_rust dependency to upstream","description":"Context: our opentui_rust fork included a fix that is now in upstream.\nTask: update dependency to an upstream release/commit and drop the fork override.\n\nPotential blocker: if we have no snapshot tests, consider adding them before upgrading to reduce regression risk (very active upstream).\n\nAcceptance:\n- dependency points to upstream (no fork override)\n- app builds; crit-ui renders without obvious regressions\n- if snapshot tests exist, update baselines or add coverage for review/diff views","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:27:57.368107545Z","created_by":"bob","updated_at":"2026-02-03T02:38:15.155305559Z","closed_at":"2026-02-03T02:38:15.155278017Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1vi","depends_on_id":"bd-3m1","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":8,"issue_id":"bd-1vi","author":"Bob","text":"Upstream status check (2026-02-02): PR #3 (present_force cursor home fix) was CLOSED, not merged. Our fork (bobisme/opentui_rust fix/present-force-cursor-home) is 1 ahead, 77 behind upstream. Upstream has had major changes (transparency compositing, layer-based hit testing, unicode normalization, BiDi). Switching to upstream requires either: (a) rebase our fork on latest and re-PR, or (b) check if upstream's renderer refactors made our fix redundant. Snapshot tests (bd-3m1) are now in place as a safety net. Unblocked.","created_at":"2026-02-03T02:17:44Z"}]}
{"id":"bd-1wp","title":"overlapping thread ranges cause duplicate code display","description":"When an orphaned thread's context range (e.g. th-1suy lines 708-741) overlaps with a diff hunk (e.g. new lines 717-746), the same code lines appear twice: once in the diff and again in the orphaned context. This makes it look like th-vy29 (anchored at line 725) is duplicated. Fix: exclude diff hunk lines from orphaned context ranges, or skip orphaned context lines that fall within rendered diff hunks.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-31T22:21:12.136606784Z","created_by":"bob","updated_at":"2026-01-31T22:31:41.622388751Z","closed_at":"2026-01-31T22:31:41.622264628Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1x1","title":"Review list: search/filter bar for title, description, and ID","description":"Add a search bar that filters reviews by title, description, or ID. Activated by mouse click or '/' key. Esc to clear. Placement TBD -- needs design exploration.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T19:21:12.145911244Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T19:48:36.181711135Z","closed_at":"2026-02-11T19:48:36.181679515Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":35,"issue_id":"bd-1x1","author":"botcrit-ui-dev","text":"Design decided: Search bar above list, below header block. Shows 'Press / to search' when inactive. When active: '/ <query>█' with cursor. Esc clears and deactivates. Filters by title, description, or review ID. Hotkey bar swaps '/ Search' for 'Esc Clear' when active.","created_at":"2026-02-11T19:38:11Z"}]}
{"id":"bd-1xu","title":"Theme picker should highlight current theme","description":"Theme picker should start with the current theme highlighted. Right now it highlights the first theme and moving down selects the second item.\n\nAcceptance:\n- opening theme picker highlights the active theme\n- moving down/up selects adjacent items correctly\n\nTesting: open theme picker, verify current theme is selected; press down selects next theme.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-01T21:25:24.557492624Z","created_by":"bob","updated_at":"2026-02-01T21:30:57.279163484Z","closed_at":"2026-02-01T21:30:57.279142044Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1yt","title":"crash when selecting 2nd-to-last thread in sidebar","description":"User reported that selecting th-gu0z (2nd-to-last thread in cr-klwd review, src/view.rs:440, orphaned) crashes the app. Could not reproduce via botty testing. May be related to layout mismatch, terminal size, or edge case in orphaned context rendering. Need to add defensive checks and debug logging.","notes":"Investigation findings: Could not reproduce through botty testing at various terminal widths (80-200 cols) and sidebar states. Tested with real crit data from botty repo. The crash was originally reported when a botty view session was running alongside, which resizes the pty. PTY resize during render is a plausible panic trigger -- found unsafe byte-index string slicing in draw_highlighted_text (diff.rs:1848,1864,1876) and draw_block_text_line (diff.rs:153). Also found overlapping orphaned context with diff hunk (bd-1wp) which may cause layout mismatch.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-31T21:45:03.616451361Z","created_by":"bob","updated_at":"2026-01-31T23:28:27.425654992Z","closed_at":"2026-01-31T23:28:16.196635217Z","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":9,"issue_id":"bd-1yt","author":"Bob","text":"Root cause: byte-index slicing on multi-byte UTF-8. Fixed with truncate_chars helper.","created_at":"2026-01-31T23:28:27Z"}]}
{"id":"bd-219","title":"Verify crit-ui works with current crit version","description":"Smoke-test crit-ui against the current crit CLI (v0.16.0+). The maw v2 bare repo model moved source files into ws/default/, so --path arguments need to point there (e.g. ~/src/botty/ws/default). Spawn crit-ui with botty, navigate views, confirm no crashes or rendering regressions.","status":"closed","priority":1,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-09T14:33:08.371171950Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-09T14:36:22.238116276Z","closed_at":"2026-02-09T14:36:22.238090157Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-24o","title":"Last comment scroll glitch","description":"When multiple comments are present, scrolling past the top of the last comment shows it from the beginning; fix so last comment respects scroll like earlier comments.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T18:03:54.952899808Z","created_by":"bob","updated_at":"2026-01-28T20:13:56.036933675Z","closed_at":"2026-01-28T20:13:56.036906955Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-25u","title":"Redesign command palette modal","description":"Rework the command palette view to use the new modal component. Wire up category support for command groups, bullet indicator for toggle states, fuzzy search, and keyboard shortcut display. See notes/modal-design.txt and reference screenshots.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:04:23.153038684Z","created_by":"bob","updated_at":"2026-01-30T16:04:52.985389115Z","closed_at":"2026-01-30T16:04:52.985366262Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-27y","title":"Command palette modal","description":"Add Ctrl+P to open a commands modal with fuzzy search across available commands.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T15:06:11.988340024Z","created_by":"bob","updated_at":"2026-01-30T16:28:05.056459599Z","closed_at":"2026-01-30T16:28:05.056428511Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-27y","depends_on_id":"bd-1gm","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-2ct","title":"Sidebar full height + footer alignment","description":"Sidebar should extend full height; footer should be right-aligned with 2-space left padding.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T18:04:31.789596986Z","created_by":"bob","updated_at":"2026-01-29T18:39:40.854642698Z","closed_at":"2026-01-29T18:39:40.854618753Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2d2","title":"Orphaned threads shown at bottom of section instead of at their file lines","description":"Orphaned threads (lines outside diff hunks) now render with file content context, but the presentation needs refinement. Currently shows ~5 lines of context with separators for excluded hunk ranges. User reports it's not quite right (specifics TBD).\n\nAcceptance criteria:\n- Orphaned threads show surrounding source lines with context\n- Context ranges don't overlap with diff hunk content\n- Comment blocks appear after the thread's context lines\n- Layout height calculation matches rendering (no scroll gaps)\n\nTesting: Open cr-klwd from /home/bob/src/botty. View src/main.rs orphaned threads (th-cwn4, th-8bit, th-krxi). Verify context, separators, and comment blocks in all 4 view modes (unified/SBS x wrap/no-wrap).","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-31T20:25:10.207401529Z","created_by":"bob","updated_at":"2026-02-02T16:25:38.442600778Z","closed_at":"2026-02-02T16:25:38.442571613Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":10,"issue_id":"bd-2d2","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-2d9","title":"all interactive text fields should support common readline shortcuts","description":"Ctrl+b Move cursor one character to the left\nCtrl+f Move cursor one character to the right\nAlt+b Move cursor one word to the left\nAlt+f Move cursor one word to the right\nCtrl+a Move cursor to start of the line\nCtrl+e Move cursor to end of the line","status":"closed","priority":2,"issue_type":"feature","owner":"botcrit-ui-dev","created_at":"2026-02-12T20:21:31.633023143Z","created_by":"bob","updated_at":"2026-02-14T22:32:05.959781556Z","closed_at":"2026-02-14T22:32:05.959755397Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["input","ux"]}
{"id":"bd-2ek","title":"Add horizontal margins for unified diff background","description":"Unified diff background bleeds edge-to-edge. Add 2 columns of horizontal margin (showing page background) on both left and right; this should be margin, not padding inside the diff.\n\nAcceptance:\n- unified diff has 2-column background margin left/right\n- side-by-side unchanged\n\nTesting: open unified diff and confirm margins show the background.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-02T17:35:25.743493962Z","created_by":"bob","updated_at":"2026-02-02T18:51:41.816227679Z","closed_at":"2026-02-02T18:51:41.816204505Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":11,"issue_id":"bd-2ek","author":"Bob","text":"Status update (2026-02-02): Unified diff margins now render correctly (2 columns of background on both sides) after scoping margins to unified view only. Side-by-side currently has no horizontal margins at edges (should remain full width). Orphaned context in unified mode renders in correct spot but the thread bar/column appears to have 4 spaces of left margin (should be 2). Orphaned context in SBS has zero margin (expected), comment threads look correct.\n\nChanges tried:\n- Added unified-only line_area inset (2 cols) and applied it only in unified rendering paths; kept SBS on full width.\n- Updated layout width calculation in update.rs to subtract unified margins for scrolling.\n- Removed diff padding to eliminate right-side padding.\n\nNext steps:\n- Keep unified margins only for diff content; avoid double-applying to thread bar for orphaned context lines.\n- Adjust orphaned context drawing to use diff_content_x(area) instead of line_area for the thread bar, or reduce orphaned_context_x by unified margin offset.\n- Verify SBS remains full-width after change.\n\nBotty was used for snapshots; rebuild before running.","created_at":"2026-02-02T18:37:42Z"},{"id":12,"issue_id":"bd-2ek","author":"Bob","text":"More detail on changes:\n- src/view/diff.rs: introduced unified_diff_area() and applied it only in unified rendering paths (render_unified_diff_line_* and orphaned context emission) so unified gets 2-col margins; SBS uses full area. diff_content_x/diff_content_width now use zero padding (DIFF_H_PAD=0).\n- src/update.rs: diff_content_width() now subtracts 2*UNIFIED_DIFF_MARGIN when diff_view_mode == Unified so scroll layout matches the inset.\n- src/stream.rs: DIFF_H_PAD set to 0 to remove right padding in layout calc.\n- src/view/review_detail.rs: prefill diff content area with theme.background so unified margins show background.\n\nRemaining issue: orphaned-context thread bar in unified appears to have 4 cols of left margin (likely unified_diff_area + orphaned_context_x + thread bar alignment). Next step is to keep unified margins for content but draw the thread bar at diff_content_x(area) relative to the full area (or reduce orphaned_context_x by UNIFIED_DIFF_MARGIN) so the bar aligns at 2 cols. SBS should remain unchanged.","created_at":"2026-02-02T18:38:25Z"}]}
{"id":"bd-2gf","title":"Syntax highlighting","description":"Add syntax highlighting for code in diff and file context views. Use tree-sitter or similar for language detection and highlighting.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-28T00:36:18.790574960Z","created_by":"bob","updated_at":"2026-01-28T01:04:38.701259194Z","closed_at":"2026-01-28T01:04:38.701241280Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2gi","title":"show all comments on reviews by default","description":"we only show one comment at a time, we should just show them all. this may break individual expansion and maybe that's ok for now","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-30T21:43:05.105955164Z","created_by":"bob","updated_at":"2026-01-30T22:40:41.548234769Z","closed_at":"2026-01-30T22:40:41.548211225Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-2je","title":"Split functions flagged by too_many_lines","description":"Remove #![allow(clippy::too_many_lines)] by splitting large functions.\n\nLikely candidates:\n- update() in update.rs (large match on Message)\n- render_diff_stream() in view/diff/mod.rs\n- Main event loop in main.rs\n\nExtract logical subsections into helper functions. Keep the main function as an orchestrator.","status":"closed","priority":3,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-03T13:15:36.808288959Z","created_by":"bob","updated_at":"2026-02-11T02:08:21.853734534Z","closed_at":"2026-02-11T02:08:21.853709787Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2jg","title":"Sidebar review metadata header","description":"Sidebar should start with review id and show commit metadata (bookmark/commit range) under it, per design.png.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T18:04:00.735776587Z","created_by":"bob","updated_at":"2026-01-28T18:16:27.055768807Z","closed_at":"2026-01-28T18:16:27.055741095Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2k5","title":"Add block horizontal margins","description":"Blocks should have 2 spaces of horizontal margin on left and right per design.txt. Apply to all right-pane blocks and pinned header.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T17:21:31.639125275Z","created_by":"bob","updated_at":"2026-01-28T17:27:11.706215965Z","closed_at":"2026-01-28T17:27:11.706170249Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ke","title":"Remove borders around UI blocks","description":"Adjust layout to remove outer borders and section frames, keeping only block styling per design. Apply to review list, sidebar, and diff pane containers.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T17:08:58.047610434Z","created_by":"bob","updated_at":"2026-01-28T17:15:19.911224395Z","closed_at":"2026-01-28T17:15:19.911205509Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2la","title":"Core Elm Architecture scaffold","description":"Create Model, Message, update(), view() scaffolding with screen navigation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T16:15:30.624447351Z","created_by":"bob","updated_at":"2026-01-27T17:07:09.224533552Z","closed_at":"2026-01-27T17:07:09.224495060Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2n7","title":"h moves focus to sidebar","description":"In diff pane, 'h' should move focus back to the file sidebar.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T18:03:57.899138800Z","created_by":"bob","updated_at":"2026-01-28T20:09:30.810965562Z","closed_at":"2026-01-28T20:09:30.810937439Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2n9","title":"Gradually remove clippy allow directives","description":"The lib.rs and main.rs files now have ~25 #![allow(clippy::...)] directives added during bd-2yu to quickly reduce warnings. Over time, address these properly:\n\n**High-value targets (fix the code):**\n- too_many_arguments → refactor to parameter structs\n- too_many_lines → split large functions\n- must_use_candidate → add #[must_use] to appropriate functions\n\n**Medium-value (improve docs):**\n- doc_markdown → add backticks to doc comments\n- missing_errors_doc → add # Errors sections\n- missing_panics_doc → add # Panics sections\n\n**Low-value (keep allowing):**\n- cast_* variants → intentional in TUI code\n- uninlined_format_args → style preference\n- similar_names → context makes them clear\n\nApproach: Pick one allow at a time, remove it, fix the warnings, commit. Don't try to do all at once.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-03T12:58:43.493106630Z","created_by":"bob","updated_at":"2026-02-03T13:15:51.051476269Z","closed_at":"2026-02-03T13:15:51.051441734Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2na","title":"when diff view dims, dim background of hotkey bar","description":"- background should be the same color as the dimmed diff pane background\n- don't dim the foreground","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-11T20:07:26.137839096Z","created_by":"bob","updated_at":"2026-02-11T20:16:32.588886965Z","closed_at":"2026-02-11T20:16:32.588865284Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-2o3","title":"incorrect sidebar highlighting","description":"- go to ~/src/botty, cr-klwd\n- go to the sidebar with h\n- j to select th-bvj1\n  - you'll see th-bvj1 highlighted _and_ src/server/mod.rs\n- j to select th-t14w\n  - you'll _also_ see src/view.rs highlighted","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-13T22:56:30.715573947Z","created_by":"bob","updated_at":"2026-02-13T23:09:46.798551706Z","closed_at":"2026-02-13T23:09:46.798521510Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["sidebar"]}
{"id":"bd-2or","title":"Reduce wide terminal threshold for side-by-side","description":"Lower the minimum width required to default to side-by-side view; current 120 is too high.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T02:51:01.138699765Z","created_by":"bob","updated_at":"2026-01-30T02:55:38.459203977Z","closed_at":"2026-01-30T02:55:38.459175213Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2p3","title":"Enable word wrapping by default","description":"Set diff_wrap to true by default in the model.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T02:51:01.178893246Z","created_by":"bob","updated_at":"2026-01-30T02:55:38.502525409Z","closed_at":"2026-01-30T02:55:38.502499320Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2px","title":"Refactor functions with too_many_arguments","description":"Remove #![allow(clippy::too_many_arguments)] by refactoring functions to use parameter structs.\n\nTarget functions (run `cargo clippy` after removing the allow to find them):\n- Rendering functions in view/diff/*.rs likely have many params (buffer, area, theme, line, etc.)\n- Consider structs like RenderContext { buffer, area, theme } or LineRenderParams\n\nKeep changes incremental - one function at a time.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-03T13:15:34.625892771Z","created_by":"bob","updated_at":"2026-02-11T01:50:32.471139482Z","closed_at":"2026-02-11T01:50:32.471114355Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2rf","title":"Theme command with preview","description":"Add a command in the command palette to open a theme picker. Highlighted theme previews instantly; Enter applies and persists to user config.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T15:06:14.191272682Z","created_by":"bob","updated_at":"2026-01-30T14:00:18.278795725Z","closed_at":"2026-01-30T14:00:18.278764727Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2rj","title":"Block formatting for right-pane sections","description":"Apply block format (vertical bar, 2-space padding, top/bottom padding and margins) to all right-pane sections: file headers, diffs, and thread/comment blocks.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-28T16:03:23.798332971Z","created_by":"bob","updated_at":"2026-01-28T16:45:03.515314561Z","closed_at":"2026-01-28T16:45:03.515289895Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2rm","title":"Theme system","description":"Implement JSON theme loading with diff color tokens","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-27T16:15:35.271980368Z","created_by":"bob","updated_at":"2026-01-28T14:59:19.919033619Z","closed_at":"2026-01-28T14:59:19.919015245Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2tb","title":"hot key footer design","description":"each hotkey should be title first in dim text, key in bright text. prefer title case. make sure to always show command palette hotkey\n\nCommands ctrl+p\n\nadd 1 row of margin to the hotkey footer. note: the content above the footer like the diff view still need 1 row of margin above the bar:\n\n_blank_\nCommands ctrl+p\n_blank_.","status":"closed","priority":2,"issue_type":"task","assignee":"bob","created_at":"2026-01-30T21:38:02.065034147Z","created_by":"bob","updated_at":"2026-01-30T22:55:51.859355404Z","closed_at":"2026-01-30T22:55:51.859328884Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-2ur","title":"Cursor traverses thread blocks row-by-row with block highlighting","description":"Currently the cursor skips over thread/comment blocks entirely. Instead, every stream row should be traversable (including comment block rows). When the cursor is anywhere within a comment block's vertical zone, highlight the whole block as a unit. Internally cursor increments by 1 stream row so j/k feels consistent. The block lights up on entry and dims on exit. This also enables natural selection of thread blocks in visual mode (bd-37q.2).","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-12T00:07:17.256558792Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-12T00:21:38.771813432Z","closed_at":"2026-02-12T00:21:38.771787463Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["cursor","ux"]}
{"id":"bd-2vb","title":"bug: sidebar thread order doesn't match diff view order","description":"Threads in the sidebar appear in a different order than they appear in the diff view. May be related to orphaned threads being sorted or positioned differently than anchored threads. Users expect sidebar order to mirror the top-to-bottom order in the diff pane.","status":"closed","priority":2,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:43:08.917729604Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T02:54:02.422662408Z","closed_at":"2026-02-11T02:54:02.422635037Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2vm","title":"Hotkey bar needs 1 row margin below","description":"The footer help bar renders at the very bottom row but needs 1 row of empty/bg margin between the last content row and the help bar for visual breathing room.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T23:11:45.190342113Z","created_by":"bob","updated_at":"2026-01-31T02:43:18.291058929Z","closed_at":"2026-01-31T02:43:18.291030747Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2vn","title":"Fetch diffs from git/jj","description":"Fetch actual diff content from git or jj based on review commit IDs. When viewing a review with a real database, run jj diff or git diff to get the unified diff for each file.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T20:42:09.808199997Z","created_by":"bob","updated_at":"2026-01-27T20:45:15.159125988Z","closed_at":"2026-01-27T20:45:15.159098016Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2yu","title":"Fix 173 clippy warnings","description":"Run cargo clippy --release and fix all warnings. These accumulated over time and were previously suppressed by global #![allow(dead_code)]. Categories likely include: unused imports, unnecessary clones, missing docs on pub items, etc. Work through systematically, possibly in batches by warning type.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T12:26:46.226274645Z","created_by":"bob","updated_at":"2026-02-03T12:37:31.432145975Z","closed_at":"2026-02-03T12:37:31.432119335Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2zu","title":"Remove inline allow(clippy::too_many_lines) on helper functions","description":"3 inline #[allow(clippy::too_many_lines)] on helper functions in view/diff/mod.rs. Split these helpers further to get under 100 lines without the allow.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:14:34.455840952Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T02:26:55.550649996Z","closed_at":"2026-02-11T02:26:55.550624338Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-31i","title":"More built-in themes","description":"Port additional themes from ~/repos/opencode to expand the built-in theme selection. Parse opencode's theme definitions and convert them to botcrit-ui Theme structs.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:28:14.102229926Z","created_by":"bob","updated_at":"2026-01-30T16:38:19.435884319Z","closed_at":"2026-01-30T16:38:19.435857038Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-32x","title":"[tracking] crit: include per-file diffs in review JSON (botcrit bd-3mz)","description":"Tracking bead for botcrit bd-3mz. Once crit includes per-file diffs and orphaned file content in `crit review --json`, update cli_client.rs to consume the new fields and remove all VCS subprocess calls from main.rs.\n\nUpstream: botcrit bd-3mz\nStatus: waiting on crit changes\n\nWhen upstream lands:\n1. Update CombinedResponse/CombinedThread serde types in cli_client.rs to parse new files array\n2. Populate FileCacheEntry.diff from JSON diff field (ParsedDiff::parse)\n3. Populate FileCacheEntry.file_content from JSON content field\n4. Remove vcs::get_file_diff and vcs::get_file_content calls from handle_data_loading and reload_review_data in main.rs\n5. Possibly remove vcs.rs entirely if no other callers remain","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-12T02:04:03.163084463Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-12T02:27:41.945663631Z","closed_at":"2026-02-12T02:27:41.945629678Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["blocked","crit","tracking"]}
{"id":"bd-34b","title":"Switch from direct SQLite to crit CLI JSON","description":"Replace direct rusqlite access to .crit/index.db with crit CLI subprocess calls using --format json. The crit CLI provides all the data we need (reviews list, review detail, threads, comments) and handles drift detection, context mapping, and deduplication that we currently don't get from raw SQL. This should also fix bd-3pk (duplicate orphaned threads) since crit's thread listing is authoritative. Key commands to use: crit reviews list --format json, crit reviews show <id> --format json, crit threads list <id> --format json, crit comments list <id> --format json, and potentially crit review <id> --format json for a single-call review+threads+comments fetch.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-02-02T20:39:17.072644066Z","created_by":"bob","updated_at":"2026-02-03T01:26:45.252576341Z","closed_at":"2026-02-03T01:26:45.252552696Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-34b.1","title":"Add CritClient trait abstracting data access","description":"Define a CritClient trait with methods matching the current Db public API: list_reviews, get_review, list_threads, get_thread, list_comments. Implement it for the existing Db (SqliteClient) so nothing breaks yet. main.rs uses the trait instead of Db directly.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:39:23.833731932Z","created_by":"bob","updated_at":"2026-02-03T01:23:57.368926267Z","closed_at":"2026-02-03T01:23:57.368902372Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-34b.1","depends_on_id":"bd-34b","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-34b.2","title":"Implement CliClient calling crit --format json","description":"Implement the CritClient trait by spawning crit subprocess calls with --format json and deserializing the output into our existing types. Commands: crit reviews list --format json --path <repo>, crit reviews show <id> --format json --path <repo>, crit threads list <id> --format json --path <repo>, crit comments list <id> --format json --path <repo>. Consider using crit review <id> --format json to fetch review+threads+comments in a single call. Handle errors (crit not found, non-zero exit, bad JSON) gracefully.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:39:29.428190723Z","created_by":"bob","updated_at":"2026-02-03T01:23:57.414773053Z","closed_at":"2026-02-03T01:23:57.414750621Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-34b.2","depends_on_id":"bd-34b","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-34b.3","title":"Wire CliClient into main.rs, make it the default","description":"Change main.rs to construct CliClient (using --path) instead of opening the SQLite Db directly. Remove the --db flag. Keep SqliteClient as a fallback or behind a flag if needed for testing. Update handle_data_loading and all call sites.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:39:34.855083223Z","created_by":"bob","updated_at":"2026-02-03T01:23:57.451797270Z","closed_at":"2026-02-03T01:23:57.451775970Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-34b.3","depends_on_id":"bd-34b","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-34b.4","title":"Remove rusqlite dependency and Db/SqliteClient","description":"Once CliClient is proven stable, remove the rusqlite dep from Cargo.toml, delete src/db.rs SqliteClient code (keep the shared types), and drop the --db CLI flag entirely. Clean up any dead code.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T20:39:39.816545218Z","created_by":"bob","updated_at":"2026-02-03T01:26:45.211843070Z","closed_at":"2026-02-03T01:26:45.211820387Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-34b.4","depends_on_id":"bd-34b","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-37q","title":"Select ranges and add comments","description":"Line-cursor-based code review interaction for the diff pane.\n\nVision:\n- Always-visible line cursor in the diff margin (┃ glyph or full box, accent color)\n- Cursor moves with j/k through actual diff lines (skipping headers, thread blocks, decoration)\n- Viewport scrolls to follow cursor at edges (vim-style)\n- When cursor lands on a thread-anchored line, the thread glyph highlights in accent color\n- Enter expands the focused thread to read comments\n- a on a focused thread opens $EDITOR to add a comment to that thread\n- v enters vim visual-line mode, j/k extends selection, a creates new thread for selected range\n- $EDITOR for comment input initially; in-TUI multi-line editor in the future (shift+a or similar)\n\nSubtasks: line cursor → visual selection → $EDITOR + crit persist\nFuture: in-TUI multi-line comment editor","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-28T17:14:46.919214150Z","created_by":"bob","updated_at":"2026-02-12T00:56:16.469540327Z","closed_at":"2026-02-12T00:56:16.469508998Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-37q.1","title":"Line cursor in diff pane","description":"Add an always-visible line cursor to the diff pane that moves through actual diff lines.\n\nDesign:\n- Track cursor position as a line index within the diff stream (not just scroll offset)\n- Cursor only lands on code lines (added, removed, context) — skip file headers, thread blocks, hunk headers, decoration\n- j/k moves cursor up/down; viewport scrolls to follow when cursor hits edge (vim-style)\n- In SBS mode, cursor spans both sides on the same row\n- Render cursor as ┃ glyph or highlighted box in the left margin using theme accent color\n- When cursor is on a line that anchors a thread, the thread's margin glyph changes to accent color — this is the \"thread is focused\" signal\n- Enter on a focused thread expands it (existing behavior, replaces n/p navigation)\n- n/p become \"jump cursor to next/prev thread-anchored line\"\n\nModel changes:\n- Add diff_cursor: usize (index into displayable diff lines)\n- Add cursor_thread: Option<String> (thread ID if cursor is on a thread-anchored line)\n- Scroll becomes viewport-follows-cursor instead of direct scroll\n\nThis is the foundational change — visual selection and commenting build on top of it.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-01-30T22:42:00.252554038Z","created_by":"bob","updated_at":"2026-02-11T23:17:15.308895034Z","closed_at":"2026-02-11T23:17:15.308871039Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-37q.1","depends_on_id":"bd-37q","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":36,"issue_id":"bd-37q.1","author":"botcrit-ui-dev","text":"Implementation plan based on architecture exploration:\n\n## Architecture findings\n\n- Diff stream has two item types: unified (DisplayLine::Diff = landable, HunkHeader = skip) and SBS (SideBySideLine where is_header=false = landable, is_header=true = skip)\n- Thread comment blocks, file headers, description blocks are all non-landable\n- Current scroll: diff_scroll is a stream row offset, StreamCursor tracks scroll/screen_row/stream_row during rendering\n- Thread positions captured during render into thread_positions: HashMap<String, usize>\n- Thread margin: ┃ in 2-char column (THREAD_COL_WIDTH), theme.background fg on line bg, shown via line_in_thread_ranges()\n\n## Implementation plan\n\n1. **Model changes**: Add `diff_cursor: usize` (stream_row index), `cursor_thread: Option<String>` (focused thread ID if cursor on thread-anchored line)\n\n2. **Landable positions**: Extend `compute_stream_layout()` to produce a `Vec<usize>` of landable stream rows (code lines only — Diff lines in unified, non-header lines in SBS). This list is recomputed on file change/view toggle.\n\n3. **Cursor movement**: j/k finds next/prev entry in the landable list. When cursor moves past viewport edge, adjust diff_scroll to follow (keep cursor N lines from edge, like vim scrolloff).\n\n4. **Cursor rendering**: During render loop, when `stream_row == diff_cursor`, draw the ┃ margin glyph in `theme.primary` (accent) instead of `theme.background`. For non-thread lines, draw the accent ┃ as the cursor indicator. For thread-anchored lines, the ┃ changes from normal thread color to accent.\n\n5. **Thread focus detection**: After cursor move, cross-reference cursor's stream_row against `thread_positions` to set `cursor_thread`. When set, the thread's margin bar renders in accent color.\n\n6. **n/p navigation**: Jump cursor to next/prev thread-anchored landable row (lookup from thread_positions + landable list intersection). Replaces current \"cycle through thread IDs\" approach.\n\n7. **Enter behavior**: When cursor_thread is Some, Enter expands that thread (existing ExpandThread message). Replaces current \"expand first thread\" default.\n\n8. **Scroll changes**: j/k no longer directly scroll — they move the cursor. ScrollUp/ScrollDown messages become CursorUp/CursorDown. Page/half-page movements move cursor by visible_height amounts. ScrollTop/ScrollBottom move cursor to first/last landable row.\n\nKey: this layers on top of existing rendering — no changes to how diff lines, thread blocks, or headers are drawn. Only the margin glyph color and scroll tracking change.","created_at":"2026-02-11T22:58:31Z"}]}
{"id":"bd-37q.2","title":"Visual line selection mode","description":"Add vim-style visual line selection in the diff pane, building on the line cursor.\n\nDesign:\n- Shift+V enters visual-line mode from the current cursor position (v is taken by view toggle)\n- j/k extends/contracts the selection (selection end = cursor line)\n- Selected range highlighted with a distinct background color (theme-based)\n- The cursor margin glyph spans the full selection range in accent color\n- Esc cancels visual mode, returns to normal cursor mode\n- a confirms selection and proceeds to comment flow (bd-37q.3)\n\nModel changes:\n- Add visual_mode: bool\n- Add visual_anchor: usize (the line where V was pressed — selection goes from anchor to cursor)\n- Selection range = min(anchor, cursor)..=max(anchor, cursor)\n\nKeybindings in visual mode:\n- j/k: move cursor (extends selection)\n- V or Esc: cancel visual mode\n- a: confirm selection, open comment flow","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-01-30T22:42:00.290813125Z","created_by":"bob","updated_at":"2026-02-12T00:37:05.337318203Z","closed_at":"2026-02-12T00:37:05.337299729Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-37q.2","depends_on_id":"bd-2ur","type":"blocks","created_at":"2026-02-12T00:07:21.045480914Z","created_by":"botcrit-ui-dev","metadata":"{}","thread_id":""},{"issue_id":"bd-37q.2","depends_on_id":"bd-37q","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-37q.2","depends_on_id":"bd-37q.1","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":13,"issue_id":"bd-37q.2","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-37q.3","title":"Comment via $EDITOR and persist via crit CLI","description":"When a comment action is triggered, open $EDITOR and persist the result via crit CLI.\n\nTwo flows:\n1. Cursor on a thread-anchored line → a opens $EDITOR → comment added to existing thread\n2. Visual selection confirmed with a → $EDITOR → new thread created for selected line range\n\n$EDITOR flow:\n- Write a temp file with optional context (file path, line range, existing thread comments)\n- Open $EDITOR (fall back to vi)\n- On save+exit, read the temp file contents as the comment body\n- If empty or editor exits non-zero, cancel\n- Clean up temp file\n\nPersist flow:\n- New thread: crit threads create <review_id> --file <path> --lines <start>-<end>, then crit comments add <thread_id> \"<body>\"\n- Existing thread: crit comments add <thread_id> \"<body>\"\n- Refresh review data after successful persist\n- Show the new/updated thread in the UI\n\nKeybinding:\n- a: open $EDITOR (current)\n- Future: A (shift+a) will keep this $EDITOR behavior when in-TUI editor is added","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-01-30T22:42:00.333567772Z","created_by":"bob","updated_at":"2026-02-12T00:56:03.830802371Z","closed_at":"2026-02-12T00:56:03.830779348Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-37q.3","depends_on_id":"bd-37q","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-37q.3","depends_on_id":"bd-37q.2","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":14,"issue_id":"bd-37q.3","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-386","title":"Right-align file change counts","description":"In file blocks, add right-aligned change counts per design.png.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T18:03:59.828728138Z","created_by":"bob","updated_at":"2026-01-28T18:16:26.551976671Z","closed_at":"2026-01-28T18:16:26.551948698Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-390","title":"Allow v toggle regardless of width","description":"Choose default diff view by width, but always let 'v' toggle unified/side-by-side even if width is small (fallback to horizontal scroll or clipped view).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-29T03:20:44.412191449Z","created_by":"bob","updated_at":"2026-01-29T19:37:00.174504070Z","closed_at":"2026-01-29T19:37:00.174423419Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-39k","title":"Single click should open review","description":"In the review list, it currently takes a double-click to open a review. Expect single left click on a row to open it.\n\nAcceptance:\n- single left click opens the clicked review\n- no double-click required\n- keyboard selection behavior unchanged\n\nTesting: run crit-ui, click a review row once to open it.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-01T21:25:24.489814790Z","created_by":"bob","updated_at":"2026-02-01T21:30:57.270473449Z","closed_at":"2026-02-01T21:30:57.270451128Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3bq","title":"thread highlighting too bright","description":"it looks good but it's a little too bright in dark themes","status":"closed","priority":4,"issue_type":"bug","created_at":"2026-02-13T22:59:27.590497603Z","created_by":"bob","updated_at":"2026-02-13T23:09:47.015023013Z","closed_at":"2026-02-13T23:09:47.014998707Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["comments","design"]}
{"id":"bd-3c7","title":"Expand comments by default","description":"Automatically expand thread comments when opening a review or selecting a file, rather than requiring manual expansion.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-29T16:36:06.269907340Z","created_by":"bob","updated_at":"2026-01-29T19:59:17.427707465Z","closed_at":"2026-01-29T19:59:17.427643145Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3cq","title":"Consider adopting updated generate-demo.sh from ~/src/botcrit","description":"Crit v0.10.0 release includes updated generate-demo.sh. Evaluate bringing it into this repo for automated testing.\n\nScope:\n- Compare current demo generation (if any) with botcrit generate-demo.sh\n- Determine integration approach (copy script, reference path, or wrap)\n- Document recommended changes\n\nAcceptance:\n- Recommendation documented with next steps\n- Any required hooks/tests identified","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:38:10.954796301Z","created_by":"bob","updated_at":"2026-02-02T04:15:54.632302427Z","closed_at":"2026-02-02T04:15:54.632266500Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3f1","title":"total code review","description":"problem: I'm having difficulty instructing the model on how to style the TUI without breaking other parts of the TUI.\n\n- do an architecture review of the entire project\n- comment on this bead how the project is structured\n- create a new bead the comprehensive details on suggested refactorying to eliminate this issue\n\nI'm suspecting we need some kind of component system for consistently syling components. Maybe we have this.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T19:00:27.081658761Z","created_by":"bob","updated_at":"2026-02-02T19:08:46.411943096Z","closed_at":"2026-02-02T19:08:46.411913190Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["review"],"comments":[{"id":15,"issue_id":"bd-3f1","author":"Bob","text":"## Architecture Review: botcrit-ui\n\n### Project Structure (21 source files)\n\n```\nsrc/\n  main.rs          (1233 lines) - Event loop, input mapping, data loading, demo mode\n  model.rs         (413 lines)  - Flat Model struct (~40 fields), Screen/Focus/LayoutMode enums\n  message.rs                    - Message enum with ~42 variants\n  update.rs        (876 lines)  - Single match on Message, state transitions\n  stream.rs        (532 lines)  - Stream layout computation (scroll math, line counting)\n  command.rs                    - Command palette command definitions\n  config.rs                     - User config (theme, default_diff_view)\n  db.rs            (288 lines)  - SQLite access layer\n  syntax.rs        (341 lines)  - Syntax highlighting via syntect\n  text.rs                       - Text wrapping utilities\n  vcs.rs           (208 lines)  - Git/jj VCS integration\n  diff/\n    mod.rs, parse.rs            - Unified diff parser\n  theme/\n    mod.rs         (523 lines)  - Theme system (seeds, overrides, loading, 10 built-in themes)\n  view/\n    mod.rs                      - Screen router (dispatches to list or detail)\n    components.rs  (185 lines)  - Shared primitives (Rect, draw_box, fill_rect, draw_text_truncated, draw_badge)\n    diff.rs        (2921 lines) - Diff rendering (unified, side-by-side, comments, context, stream)\n    review_list.rs (279 lines)  - Review list screen\n    review_detail.rs (479 lines)- Review detail screen (sidebar + diff pane)\n    command_palette.rs (337 lines)- Command/theme picker modal\n```\n\n### Elm Architecture Flow\n\n**Model** (model.rs): Single flat struct with ~40 fields covering screen state, data, UI state, command palette, commenting, layout, theme, and a `RefCell<HashMap>` for thread positions written during view.\n\n**Messages** (message.rs): ~42 variants covering navigation, scrolling, file selection, thread management, focus, diff view toggling, command palette, commenting, theme, and system events.\n\n**Update** (update.rs): Single `fn update(&mut Model, Message)` with a large match. Directly mutates model. Some recursive dispatch (CommandPaletteExecute -> HideCommandPalette + action). Helpers for file navigation, scroll clamping, and thread centering.\n\n**View** (view/mod.rs): Dispatches to `review_list::view` or `review_detail::view` based on `model.screen`, then overlays command palette. Views call `buffer.draw_text()` and `buffer.fill_rect()` imperatively.\n\n**Event Loop** (main.rs): render -> check quit -> load data -> poll input -> map to message -> update. Input mapping functions serve as a \"controller\" layer. Data loading (DB queries, VCS diffs) happens as side effects in the loop.\n\n### Styling System\n\nThe `Theme` struct is the central styling authority with:\n- 7 base/UI colors (background, foreground, border, border_focused, panel_bg, selection_bg/fg, cursor)\n- 5 semantic colors (primary, success, warning, error, muted)\n- `DiffTheme` sub-struct (12 colors for diff rendering)\n- `SyntaxColors` sub-struct (11 colors for syntax highlighting)\n\nThemes are constructed from 7 \"seed\" colors with all others derived via lerp/blend. Optional overrides can fine-tune any derived color. 10 built-in themes are embedded at compile time.\n\n**How styles are applied**: Every view function accesses `model.theme` directly and constructs `Style` values inline at each draw call site. There are no pre-built \"style tokens\" or \"style constants\" -- each `buffer.draw_text()` call builds its own `Style::fg(theme.foreground).with_bg(theme.background)`.\n\n### Component System\n\n**There is no formal component system.** The closest things are:\n- `view/components.rs`: Shared primitives (Rect, draw_box, fill_rect, etc.)\n- `StreamCursor` in diff.rs: Virtual scroll abstraction tracking stream_row vs screen_row\n- Various private helper functions within each view file\n\nNo component trait, no declarative composition, no isolated/testable components. Each view is a collection of imperative draw calls.\n\n### Key Architectural Issues\n\n1. **diff.rs is 2921 lines** -- contains unified diff, side-by-side, comments, context, thread range bars, file headers, pinned headers, highlight text, text wrapping, stream orchestration, AND legacy standalone renderers\n\n2. **Duplicated layout constants** -- DIFF_H_PAD, DIFF_MARGIN, ORPHANED_CONTEXT_LEFT_PAD are defined independently in diff.rs, stream.rs, and update.rs with only comments (\"Must match DIFF_MARGIN in diff.rs\") maintaining sync\n\n3. **Stream layout must mirror rendering** -- stream.rs computes line counts that diff.rs must emit exactly, but they are separate implementations. If rendering emits different row counts than layout predicts, scrolling breaks silently\n\n4. **Duplicated help bars** -- review_list.rs and review_detail.rs each have their own draw_help_bar with different data structures but identical algorithms\n\n5. **Duplicated dim_rect** -- review_detail.rs::dim_rect and command_palette.rs::dim_background are nearly identical\n\n6. **RefCell thread_positions** -- view writes thread screen positions into a RefCell that update reads for navigation. Breaks the pure Elm contract, creates temporal coupling\n\n7. **Legacy renderers** -- render_diff_with_threads, render_diff_side_by_side, render_file_context exist alongside render_diff_stream, adding confusion\n\n8. **main.rs mixes concerns** -- input mapping, data loading, demo data, argument parsing, editor launching all in 1233 lines","created_at":"2026-02-02T19:07:29Z"},{"id":16,"issue_id":"bd-3f1","author":"Bob","text":"Created bd-9xj with comprehensive refactoring plan: 7 phases covering layout constant centralization, style tokens, diff.rs split, shared components, legacy cleanup, and input extraction. Priority order starts with the mechanical changes (layout.rs, style tokens) that have the highest impact on the styling fragility problem.","created_at":"2026-02-02T19:08:43Z"}]}
{"id":"bd-3i3","title":"Diff parser and renderer","description":"Parse unified diff format and render with line numbers, colors, and backgrounds","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T16:15:32.657148133Z","created_by":"bob","updated_at":"2026-01-27T20:42:04.882992331Z","closed_at":"2026-01-27T20:42:04.882947837Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3j9","title":"Side-by-side diff view for wide terminals","description":"Show side-by-side diffs when the pane is wide enough (e.g., >= 120 cols for diff pane), fall back to unified diff for narrower terminals.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T00:36:20.448435016Z","created_by":"bob","updated_at":"2026-01-28T00:43:17.539449199Z","closed_at":"2026-01-28T00:43:17.539412570Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3jo","title":"Side-by-side diff lacks syntax highlighting","description":"Side-by-side diff view should render syntax-highlighted code like unified diff. Currently side-by-side uses plain colors.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T12:32:46.211014926Z","created_by":"bob","updated_at":"2026-01-28T12:43:14.504140820Z","closed_at":"2026-01-28T12:43:14.504113248Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3ju","title":"Bottom margin below diff contents","description":"Add 1-row margin between diff contents and footer (content area should end 1 row above footer).","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T18:04:33.321377913Z","created_by":"bob","updated_at":"2026-01-29T18:18:11.517207795Z","closed_at":"2026-01-29T18:18:11.517182538Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3k7","title":"g/G to go to top/bottom of scrollable","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-02T02:31:05.733773474Z","created_by":"bob","updated_at":"2026-02-02T04:49:08.333721915Z","closed_at":"2026-02-02T04:49:08.333694964Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-3kl","title":"Sidebar focus highlight and selected icon","description":"Only show file list background highlight when sidebar is focused; use ◉ for selected file indicator.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T18:04:36.268497217Z","created_by":"bob","updated_at":"2026-01-29T18:18:09.620062581Z","closed_at":"2026-01-29T18:18:09.620033797Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3lt","title":"Show file context for threads without diff","description":"When a file has threads but no diff (reviewer commented on unchanged code), fetch and display the file content around the thread's line numbers instead of showing 'no diff loaded'. This provides context for the comments.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T00:10:59.549914510Z","created_by":"bob","updated_at":"2026-01-28T00:16:37.090770706Z","closed_at":"2026-01-28T00:16:37.090749286Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3m1","title":"Add snapshot testing for crit-ui views","description":"Context: We rely on opentui_rust which is very active.\nTask: add snapshot testing to validate crit-ui renders (review list, unified diff, side-by-side diff, thread rendering) to reduce upgrade regression risk.\n\nAcceptance:\n- snapshot test harness in place and documented\n- baseline snapshots committed for key views (review list, unified diff, SBS diff, thread rendering)\n- tests are runnable locally","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:28:17.598890104Z","created_by":"bob","updated_at":"2026-02-03T02:17:37.698585948Z","closed_at":"2026-02-03T02:17:30.773395867Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":17,"issue_id":"bd-3m1","author":"Bob","text":"Snapshot plan (draft):\n- Use Botty to render stable plain-text snapshots (spawn crit-ui, wait, snapshot).\n- Fix terminal size for deterministic layout (decide on PTY sizing or env-based sizing).\n- Pin data: use a fixture review (e.g., export cr-klwd or copy fixtures into tests/fixtures) so snapshots do not drift.\n- Capture baseline views: review list, unified diff, side-by-side diff, thread rendering (anchored + orphaned).\n- Provide a runner (scripts/snapshots.sh or Rust test) that diffs current output vs tests/snapshots/*.txt and fails on mismatch; document the command.","created_at":"2026-02-01T19:29:10Z"},{"id":18,"issue_id":"bd-3m1","author":"Bob","text":"Snapshot testing is complete. scripts/snapshot-test.sh covers 5 views: review list, unified diff, SBS diff, file navigation, sidebar focus. Baselines committed in tests/snapshots/. Supports UPDATE_SNAPSHOTS=1 for regeneration. Uses botty spawn with --no-resize for deterministic terminal sizing. Closing.","created_at":"2026-02-03T02:17:37Z"}]}
{"id":"bd-3mp","title":"orphaned context style differs from diff style","description":"The orphaned thread context uses plain line numbers without +/- markers, which looks visually different from the diff rendering. Low priority cosmetic issue.\n\nNOTE: Ask bob about this before starting -- he may have specific ideas about the desired style.\n\nAcceptance criteria:\n- Orphaned context lines have consistent styling with diff context lines (TBD with bob)\n- Line number column alignment matches diff pane\n\nTesting: Open cr-klwd, scroll to orphaned threads in server/mod.rs. Compare visual style with diff hunks above.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-31T22:21:06.568512893Z","created_by":"bob","updated_at":"2026-02-02T03:53:21.120749040Z","closed_at":"2026-02-02T03:53:21.120720778Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":19,"issue_id":"bd-3mp","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-3n4","title":"comment input design changes","description":"- there needs to be 1 row of vertical padding at the top of the modal, currently 0\n- remove the \"┃ \" on the left of the text input\n- change the key hints from \"Ctrl+S submit  Esc cancel\" to \"Submit ctrl+s  Cancel esc\" just like the normal hotkey bar\n- there seem to 2 blank lines at the bottom of the multi-line input. should be zero\n- change the fg color of the modal title \"New comment on ...\" to be the same as the \"esc\"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-14T15:45:59.663290238Z","created_by":"bob","updated_at":"2026-02-14T22:27:45.723582097Z","closed_at":"2026-02-14T22:27:45.723553965Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["comment","design"]}
{"id":"bd-3n7","title":"Use \r\r glyph to start comment arm","description":"For comment blocks, replace the first line of the vertical comment bar with the \r\r glyph to make the arm feel attached to the diff. Subsequent lines keep the standard bar.\n\nAcceptance:\n- first row of comment bar uses \r\r glyph\n- rest of bar uses \r\r\n- comment layout unchanged\n\nTesting: open a thread with comments and verify the new top glyph.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-02T17:35:25.776860931Z","created_by":"bob","updated_at":"2026-02-02T17:40:39.706748292Z","closed_at":"2026-02-02T17:40:39.706709379Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":20,"issue_id":"bd-3n7","author":"Bob","text":"Clarification: glyph is '' (Nerd Font) for the first comment-arm row.","created_at":"2026-02-02T17:36:34Z"}]}
{"id":"bd-3nd","title":"Remove inline allow(clippy::too_many_arguments) via parameter structs","description":"9 inline #[allow(clippy::too_many_arguments)] across the codebase, mostly in view/diff/mod.rs. Bundle function parameters into config/context structs to reduce arg count below the 7-arg limit.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:14:32.683679436Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T02:26:55.433386278Z","closed_at":"2026-02-11T02:26:55.433360289Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3pk","title":"Threads with anchors in diff hunks are duplicated as orphaned threads","description":"Threads with anchors in diff hunks are duplicated as orphaned threads. Likely fixed by bd-34b (switching to crit CLI) since crit handles thread deduplication authoritatively.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-31T20:25:06.037835930Z","created_by":"bob","updated_at":"2026-02-03T01:46:01.101226862Z","closed_at":"2026-02-03T01:46:01.101197647Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":21,"issue_id":"bd-3pk","author":"Bob","text":"Could not reproduce SBS duplication after the exclude_ranges clipping fix. Tested: scrolled through entire SBS view of server/mod.rs. th-vy29 appears once anchored at line 725, th-1suy appears once in orphaned section. Will re-check at different terminal widths.","created_at":"2026-01-31T23:28:33Z"},{"id":22,"issue_id":"bd-3pk","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"},{"id":23,"issue_id":"bd-3pk","author":"Bob","text":"Repro note: From /home/bob/src/botty, run crit-ui and open review cr-klwd. Navigate to src/server/mod.rs, toggle side-by-side (v), and scroll the full file. At some terminal widths, th-1suy duplicates (one in orphaned context, one anchored in diff). th-vy29 may also duplicate.","created_at":"2026-02-01T19:22:22Z"},{"id":24,"issue_id":"bd-3pk","author":"Bob","text":"Note: thread th-385w appears duplicated during sidebar highlight sync testing (SBS mode). Please investigate as part of this bead.","created_at":"2026-02-02T03:24:30Z"},{"id":25,"issue_id":"bd-3pk","author":"Bob","text":"Root cause found and fixed. Two bugs:\n\n1. SBS anchor/comment maps matched old-side line numbers (view/diff.rs:966-983). The sbs_anchor_map and sbs_comment_map checked both sl.left and sl.right for matching thread line numbers. When an old-side line number coincidentally equaled a thread's selection_start/end (e.g., old line 725 = th-vy29's selection_start 725), the thread comment rendered at both the new-side anchor AND the old-side match. Fix: only match on sl.right (new side), consistent with map_threads_to_diff.\n\n2. Orphaned context exclusion ranges only covered new-side hunk lines (view/diff.rs, stream.rs). The hunk_ranges used to clip orphaned context were built from (new_start, new_start+new_count-1) only. When an orphaned thread's context window overlapped with old-side diff lines (e.g., th-1suy context 708-741 vs old-side 710-716 in hunk 2), those lines appeared in both orphaned context and the diff. Fix: new hunk_exclusion_ranges() helper in diff/parse.rs computes union of old+new side ranges, merged.\n\nRepro: cr-klwd, src/server/mod.rs, SBS mode. th-vy29 (selection_start=725) appeared twice - once at new line 725, once after old line 725. th-1suy orphaned context showed old lines 710-716 that also appeared in the diff hunk.","created_at":"2026-02-03T01:45:57Z"}]}
{"id":"bd-3pw","title":"Color verification script","description":"Shell script using botty snapshot --raw to extract rendered ANSI RGB values and compare against expected theme colors. Automated pass/fail per theme.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T18:17:31.896428346Z","created_by":"bob","updated_at":"2026-01-30T18:38:04.616494139Z","closed_at":"2026-01-30T18:38:04.616390194Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3pw","depends_on_id":"bd-z91","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-3q4","title":"Extended scroll keybindings","description":"Support u/d for half-page, b/f for full-page, and Ctrl+J/Ctrl+K for 10-line scroll in diffs/files.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T18:03:53.337608676Z","created_by":"bob","updated_at":"2026-01-28T20:09:28.192500647Z","closed_at":"2026-01-28T20:09:28.192481812Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3qd","title":"Increase sidebar vertical padding","description":"Sidebar should have 2 rows of vertical padding at top and bottom (currently 1).","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T18:04:31.451925675Z","created_by":"bob","updated_at":"2026-01-29T18:39:35.244062918Z","closed_at":"2026-01-29T18:39:35.244031459Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3tc","title":"support --path to open crit-ui in different dir","description":"would be hande for testing. I just added support for this to ~/src/crit.\ncheck how that was implemented. this would be helpful in testing so I don't have to cd to ~/src/botty every time","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-02T00:25:11.281419931Z","created_by":"bob","updated_at":"2026-02-02T15:59:59.432998948Z","closed_at":"2026-02-02T15:59:59.432971547Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-3tf","title":"if thread is for a line range, show below last line","description":"right now it shows below first line, splitting the context","status":"closed","priority":1,"issue_type":"feature","assignee":"bob","created_at":"2026-01-30T21:34:15.756555647Z","created_by":"bob","updated_at":"2026-01-30T22:54:31.616211311Z","closed_at":"2026-01-30T22:54:31.616188288Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-3ty","title":"Show loading splash when opening review","description":"Selecting a review from the main list can lag while data loads. Show a transient loading view or overlay so the UI feels responsive.\n\nAcceptance:\n- selecting a review shows a \"Loading review\" splash until data is ready\n- splash clears once review loads\n- no regressions to navigation\n\nTesting: open a review with a large diff and confirm the loading splash appears briefly.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-01T21:25:24.523709276Z","created_by":"bob","updated_at":"2026-02-01T21:30:57.280250621Z","closed_at":"2026-02-01T21:30:57.279153375Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3ul","title":"Remove right padding in diff panes","description":"All diff views show a 1-column padding on the right. Remove this extra right padding.\n\nAcceptance:\n- no extra trailing padding column on the right of diff content\n- unified and side-by-side both updated\n\nTesting: open a diff and confirm content reaches the right boundary as intended.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-02T17:35:25.710556939Z","created_by":"bob","updated_at":"2026-02-02T17:57:48.785771257Z","closed_at":"2026-02-02T17:57:48.785741862Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3un","title":"review crit review --json ouput","description":"not a big deal, but the json output looks really noisy. it's the main input for crit-ui. should we request changes so it's *better* for crit-ui to consume?","status":"closed","priority":3,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T19:01:07.178903633Z","created_by":"bob","updated_at":"2026-02-12T02:04:09.366701453Z","closed_at":"2026-02-12T01:20:09.466104780Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["crit"],"comments":[{"id":38,"issue_id":"bd-3un","author":"botcrit-ui-dev","text":"Added --no-context to crit review CLI call. The context field (code snippets around threads) was 76% of the JSON payload (~28KB of 37KB for a 14-thread review) and completely unused by crit-ui (we fetch diffs from git directly). The fix is a one-line change in cli_client.rs.","created_at":"2026-02-12T01:20:04Z"},{"id":39,"issue_id":"bd-3un","author":"botcrit-ui-dev","text":"Follow-up: the --no-context change was reverted. Instead of stripping data, we filed a feature request against crit to include per-file diffs in the review JSON response, eliminating all VCS calls. See botcrit bd-3mz and local tracking bead bd-32x.","created_at":"2026-02-12T02:04:09Z"}]}
{"id":"bd-6c6","title":"Fix cursor visible area calculation (off by pinned header height)","description":"ensure_cursor_visible uses model.height.saturating_sub(2) as the visible row count, but doesn't account for the pinned header block at the top of the stream area. The cursor scrolls just below the visible portion when moving down. Fix: subtract pinned header height from the visible area calculation.","status":"closed","priority":1,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-12T00:07:14.205799465Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-12T00:10:19.155767880Z","closed_at":"2026-02-12T00:10:19.155741401Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["cursor","ux"]}
{"id":"bd-6gi","title":"bug: long comments disappear bottom-up instead of top-down when scrolling","description":"When scrolling a long comment block off the top of the screen, lines disappear from the bottom of the comment instead of the top. Expected: as you scroll down, the top lines of the comment scroll off-screen first. Actual: bottom lines vanish first, making the comment shrink upward. Repro: crit-ui --path ~/src/botty/ws/default --review cr-hdox --thread th-za40, scroll down until the comment is at the top, keep scrolling.","status":"closed","priority":2,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:43:12.644077344Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T02:54:02.313676283Z","closed_at":"2026-02-11T02:54:02.313658379Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-7f5","title":"unified diff need 2 spaces of horizontal padding on left and right","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T21:44:12.574845192Z","created_by":"bob","updated_at":"2026-01-30T22:40:45.684791852Z","closed_at":"2026-01-30T22:40:45.684763288Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-7m0","title":"Show only context lines around threads in file view","description":"Instead of showing the entire file, only show a window of lines around each thread (e.g., 5 lines before/after the thread range). Jump between thread contexts.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T00:36:17.463099554Z","created_by":"bob","updated_at":"2026-01-28T00:39:24.373945991Z","closed_at":"2026-01-28T00:39:24.373923018Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-81x","title":"Remove divider gap in side-by-side diffs","description":"There is a visible space between the two panes in side-by-side diff mode. Remove the divider gap so panes touch.\n\nAcceptance:\n- no blank column between panes in side-by-side view\n- unified view unchanged\n\nTesting: toggle side-by-side (v) and verify panes touch.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-02T17:35:25.677535459Z","created_by":"bob","updated_at":"2026-02-02T17:48:39.439336074Z","closed_at":"2026-02-02T17:48:39.439313702Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-852","title":"Evaluate AGENTS.md workflow updates for crit v0.10.0","description":"Crit v0.10.0 adds new flags/features (format output options, JSON file context, --path, workspace info). Evaluate how our implementation, scripts, and testing in AGENTS.md should change.\n\nScope:\n- Review AGENTS.md guidance for crit commands and outputs\n- Identify needed updates to scripts/tests that parse crit output\n- Note any improvements we can leverage (JSON output, --path)\n\nAcceptance:\n- Proposed updates documented (comments or checklist)\n- No breaking guidance left in AGENTS.md","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:38:10.920485638Z","created_by":"bob","updated_at":"2026-02-02T04:01:24.401106387Z","closed_at":"2026-02-02T04:01:24.401076621Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-92q","title":"diff content text looks dim","description":"now sure why this is, but we should make it brighter (ideally without making it out of compliance with color scheme)","status":"closed","priority":3,"issue_type":"task","assignee":"bob","created_at":"2026-01-30T21:39:22.004772635Z","created_by":"bob","updated_at":"2026-01-30T22:56:56.198557918Z","closed_at":"2026-01-30T22:56:56.198529644Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-9d7","title":"Exploratory code audit and fixes","description":"Deeply inspect selected code paths and fix obvious bugs discovered during methodical review.","status":"closed","priority":2,"issue_type":"task","owner":"1","created_at":"2026-02-18T21:37:29.540296321Z","created_by":"1","updated_at":"2026-02-18T21:47:00.893779844Z","closed_at":"2026-02-18T21:47:00.893743807Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-9xj","title":"Refactor: centralize layout constants, style tokens, and split diff.rs","description":"Comprehensive refactoring to eliminate styling fragility. See bead comment for full plan with 7 phases: (1) centralize layout constants in layout.rs, (2) add style token methods to Theme, (3) split 2921-line diff.rs into sub-modules, (4) shared help bar component, (5) shared dim_rect, (6) remove legacy renderers, (7) extract input mapping from main.rs.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T19:08:35.525199205Z","created_by":"bob","updated_at":"2026-02-03T12:23:07.204431683Z","closed_at":"2026-02-03T12:23:07.204405253Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-9xj","depends_on_id":"bd-3m1","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":26,"issue_id":"bd-9xj","author":"Bob","text":"## Problem\n\nStyling changes in one view frequently break other views because:\n\n1. Layout constants (DIFF_H_PAD, DIFF_MARGIN, ORPHANED_CONTEXT_LEFT_PAD, thread_col_width, line_num_width, divider_width) are duplicated across diff.rs, stream.rs, and update.rs with only comments maintaining sync\n2. Styles are constructed ad-hoc at every draw call site -- there are no shared style tokens, so a \"selection row\" in review_list.rs uses a different construction pattern than in review_detail.rs\n3. diff.rs at 2921 lines mixes layout computation, style selection, and draw calls in the same functions, making it impossible to change one concern without risking the others\n4. The stream layout (stream.rs) and stream rendering (diff.rs) must emit exactly matching row counts but are separate implementations -- a styling change that affects row counts (e.g., adding padding) must be changed in both places\n\n## Proposed Refactoring\n\n### Phase 1: Centralize Layout Constants (low risk, high impact)\n\nCreate `src/layout.rs` as the single source of truth for all layout constants:\n\n```rust\n// src/layout.rs\npub const DIFF_H_PAD: u32 = 0;\npub const DIFF_MARGIN: u32 = 2;\npub const ORPHANED_CONTEXT_LEFT_PAD: u32 = 2;\npub const THREAD_COL_WIDTH: u32 = 2;\npub const UNIFIED_LINE_NUM_WIDTH: u32 = 12;\npub const SBS_LINE_NUM_WIDTH: u32 = 6;\npub const CONTEXT_LINE_NUM_WIDTH: u32 = 6;\npub const DIVIDER_WIDTH: u32 = 0;\npub const COMMENT_H_MARGIN: u32 = 2;\npub const COMMENT_H_PAD: u32 = 2;\n// Block constants (already partially centralized in stream.rs):\npub const BLOCK_MARGIN: usize = 1;\npub const BLOCK_PADDING: usize = 1;\npub const BLOCK_SIDE_MARGIN: u32 = 2;\npub const BLOCK_LEFT_PAD: u32 = 2;\npub const BLOCK_RIGHT_PAD: u32 = 2;\npub const SIDE_BY_SIDE_MIN_WIDTH: u32 = 100;\n```\n\nThen derive all widths from these constants via shared functions:\n\n```rust\npub fn diff_content_width(pane_width: u32) -> u32 { ... }\npub fn unified_wrap_width(pane_width: u32) -> usize { ... }\npub fn sbs_wrap_widths(pane_width: u32) -> (usize, usize) { ... }\n```\n\ndiff.rs, stream.rs, and update.rs all import from layout.rs. This eliminates the \"Must match X in Y.rs\" comments entirely.\n\n### Phase 2: Style Tokens (low risk, medium impact)\n\nAdd computed style accessors to `Theme` itself so views use semantic style tokens instead of constructing styles inline:\n\n```rust\nimpl Theme {\n    pub fn text(&self) -> Style { Style::fg(self.foreground).with_bg(self.background) }\n    pub fn text_muted(&self) -> Style { Style::fg(self.muted).with_bg(self.background) }\n    pub fn text_bold(&self) -> Style { Style::fg(self.foreground).with_bg(self.background).with_bold() }\n    pub fn selection(&self) -> Style { Style::fg(self.selection_fg).with_bg(self.selection_bg) }\n    pub fn selection_accent(&self) -> Style { Style::fg(self.primary).with_bg(self.selection_bg) }\n    pub fn panel_text(&self) -> Style { Style::fg(self.foreground).with_bg(self.panel_bg) }\n    pub fn panel_muted(&self) -> Style { Style::fg(self.muted).with_bg(self.panel_bg) }\n    pub fn diff_added_line(&self) -> Style { Style::fg(self.diff.added).with_bg(self.diff.added_bg) }\n    pub fn diff_removed_line(&self) -> Style { Style::fg(self.diff.removed).with_bg(self.diff.removed_bg) }\n    pub fn diff_context_line(&self) -> Style { Style::fg(self.diff.context).with_bg(self.diff.context_bg) }\n    // etc.\n}\n```\n\nThis gives a vocabulary for styling that views share. When you change how \"selection\" looks, you change it once in Theme::selection() and it applies everywhere.\n\n### Phase 3: Split diff.rs into Sub-Modules (medium risk, high impact)\n\nBreak the 2921-line diff.rs into focused sub-modules:\n\n```\nsrc/view/diff/\n  mod.rs              - Re-exports, shared types (ThreadAnchor, ChangeCounts, DisplayLineKind)\n  stream.rs           - render_diff_stream orchestration (the main entry point)\n  unified.rs          - Unified diff line rendering (render_unified_diff_line_block, _wrapped_row)\n  side_by_side.rs     - Side-by-side rendering (render_side_by_side_line_block, _wrapped_row)\n  comments.rs         - Comment block rendering (emit_comment_block, draw_comment_bar)\n  context.rs          - File context and orphaned context rendering\n  header.rs           - File header blocks and pinned headers\n  highlight.rs        - draw_highlighted_text, wrap_content, wrap_highlight_spans\n  cursor.rs           - StreamCursor abstraction\n```\n\nEach sub-module handles one concern. The stream.rs orchestrator calls into the others.\n\n### Phase 4: Shared Help Bar Component (low risk, low impact)\n\nUnify the two help bar implementations into components.rs:\n\n```rust\npub struct HotkeyHint<'a> {\n    pub label: &'a str,\n    pub key: &'a str,\n}\n\npub fn draw_help_bar(\n    buffer: &mut OptimizedBuffer,\n    area: Rect,\n    theme: &Theme,\n    hints: &[HotkeyHint],\n) { ... }\n```\n\nBoth review_list.rs and review_detail.rs call this shared function.\n\n### Phase 5: Shared dim_rect (low risk, low impact)\n\nMove dim_rect into components.rs:\n\n```rust\npub fn dim_rect(buffer: &mut OptimizedBuffer, area: Rect, scale: f32) { ... }\n```\n\nreview_detail.rs calls `dim_rect(buffer, area, 0.7)` and command_palette.rs calls `dim_rect(buffer, area, 0.35)`.\n\n### Phase 6: Remove Legacy Renderers (low risk, medium impact)\n\nDelete `render_diff_with_threads`, `render_diff`, `render_diff_side_by_side`, and `render_file_context` -- the standalone renderers that `render_diff_stream` has replaced. Verify they have no remaining callers first. Currently `render_diff` calls `render_diff_with_threads` internally and `render_file_context` is re-exported in view/mod.rs but may not be called.\n\n### Phase 7 (Optional): Extract Input Mapping from main.rs\n\nMove `map_review_list_key`, `map_review_detail_key`, `map_command_palette_key`, and the mouse mapping functions into a dedicated `src/input.rs` module. This reduces main.rs from ~1233 to ~600 lines and separates the \"controller\" layer from the event loop.\n\n## Priority Order\n\n1. **Phase 1** (layout.rs) -- Eliminates the #1 source of cross-file breakage. Pure mechanical refactor with no behavior change.\n2. **Phase 2** (style tokens) -- Establishes a shared vocabulary that prevents ad-hoc style divergence. Incremental: start with the most-used patterns and expand.\n3. **Phase 3** (split diff.rs) -- Reduces the cognitive load of the largest file. Each sub-module becomes independently reviewable.\n4. **Phases 4-5** (shared help bar, dim_rect) -- Quick deduplication wins.\n5. **Phase 6** (remove legacy) -- Dead code removal.\n6. **Phase 7** (input.rs) -- Nice-to-have cleanup.\n\n## What About a Full Component System?\n\nA formal component system (e.g., a `Component` trait with `render(&self, &mut Buffer, Rect)`) would add abstraction overhead that may not pay off for a TUI of this size. The existing Elm architecture (Model/Message/Update/View) is already a good separation of concerns. The real problems are:\n\n- Constants not centralized (Phase 1 fixes this)\n- Styles not tokenized (Phase 2 fixes this)\n- One file doing too much (Phase 3 fixes this)\n- Small duplications (Phases 4-5 fix these)\n\nA component trait would mainly help if you had many independently scrollable, interactive sub-views. Currently the app has two screens (list and detail) with the diff stream being the only complex scrollable area. The `StreamCursor` already serves as a de facto rendering abstraction for that case. Adding a generic component system would likely just add indirection without solving the actual pain points.","created_at":"2026-02-02T19:08:39Z"}]}
{"id":"bd-a4m","title":"fix: crit reviews list JSON format changed to wrapped object","description":"crit CLI now returns {advice, count, reviews: [...]} instead of a bare array for 'reviews list'. CliClient::list_reviews tries to deserialize as Vec<ReviewSummary> and fails. Need to add a wrapper struct to extract the 'reviews' field.","status":"closed","priority":1,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-11T02:37:18.453675020Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T02:38:01.970135286Z","closed_at":"2026-02-11T02:38:01.970112784Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-ac7","title":"Thread anchoring and inline display","description":"Anchor threads to diff lines and render inline comment bubbles","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T16:15:34.398667699Z","created_by":"bob","updated_at":"2026-01-27T22:56:42.968981165Z","closed_at":"2026-01-27T22:56:42.968953272Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-adt","title":"Add backticks to doc comments (doc_markdown)","description":"Remove #![allow(clippy::doc_markdown)] by adding backticks around code references in doc comments.\n\nExamples:\n- `CritClient` not CritClient\n- `opentui_rust` not opentui_rust\n- `Model` not Model\n\nCan be done file-by-file. Low risk, improves generated docs.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-02-03T13:15:41.345136358Z","created_by":"bob","updated_at":"2026-02-11T01:03:51.670601887Z","closed_at":"2026-02-11T01:03:51.670572382Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-bbe","title":"support --review <id>, --file <rel-path>, --thread <thread-id>","description":"should skip the main menu and open the review directly.\nif it doesn't exist, drop in main menu anyway.\nthis will help speed up automated testing too.\nfail gracefully.\nall flags optional.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-02T18:45:26.808067598Z","created_by":"bob","updated_at":"2026-02-02T20:33:05.535035557Z","closed_at":"2026-02-02T20:33:05.535012554Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-bdf","title":"Bug: Editor launch uses incorrect line number after first file","description":"Opening the editor (o) jumps to the correct line for the first file, but subsequent files land at the bottom, possibly reusing the first file's line number.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T02:51:01.210040826Z","created_by":"bob","updated_at":"2026-01-30T02:55:38.549209923Z","closed_at":"2026-01-30T02:55:38.549182892Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-bn8","title":"Top line redraw glitch","description":"First line of the TUI gets overwritten when selecting different files; investigate and fix redraw so header line is stable.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T17:21:35.258567397Z","created_by":"bob","updated_at":"2026-01-28T17:27:12.982870341Z","closed_at":"2026-01-28T17:27:12.982840845Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-c5o","title":"dimm the diff pane when the sidebar is focused","description":"When the sidebar is focused (Navigate mode), the diff pane should be visually dimmed to make focus obvious. Currently there's no visual distinction between sidebar-focused and diff-focused states.\n\nAcceptance criteria:\n- Diff pane text/colors are visually dimmed when sidebar has focus\n- Diff pane returns to normal brightness when focus moves back to it\n- Dimming should be subtle enough to still read the diff, but clear enough to indicate unfocused state\n\nTesting: Open a review, press s to toggle sidebar focus. Verify diff pane dims. Press Enter on a thread to enter scroll mode. Verify diff pane returns to normal.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T15:02:06.117242417Z","created_by":"bob","updated_at":"2026-02-02T00:26:49.955106927Z","closed_at":"2026-02-02T00:26:49.955039611Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"comments":[{"id":27,"issue_id":"bd-c5o","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-c8c","title":"Refresh TUI on terminal resize","description":"Resizing the terminal should immediately refresh the UI. Currently the TUI only updates after another event. Ensure resize triggers a redraw (likely set model.needs_redraw = true in Resize handling).","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T12:16:58.878609486Z","created_by":"bob","updated_at":"2026-01-28T13:16:53.740029975Z","closed_at":"2026-01-28T13:16:53.740002563Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-ckn","title":"Refine side-by-side diff visuals","description":"Apply design tweaks: remove visible vertical separator, dim right-side line numbers, avoid +/- sign highlights, and reduce @@ header noise while still separating hunks.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-28T12:32:48.306602112Z","created_by":"bob","updated_at":"2026-01-28T12:43:15.457186388Z","closed_at":"2026-01-28T12:43:15.457036507Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-d6d","title":"comment redesign","description":"Redesign comment block rendering per notes/comment-redesign.txt:\n1. Remove unicode glyphs for expanded/collapsed state\n2. Remove the 1-line top margin between diff line and comment block (only for comment blocks, not all blocks)\n3. Have the left edge bar (┃) extend upward from the comment box to cover the lines the thread applies to, using same background color\n\nAcceptance criteria:\n- No ▽/▷ glyphs on thread anchor lines\n- Comment block starts immediately below the last diff line of the thread range (no gap)\n- Left bar (┃ + 1 space with panel_bg) covers the thread's line range above the comment box\n- Existing comment content rendering is unchanged\n\nTesting: Open cr-klwd, view any file with threads. Verify the new comment style. Check in all 4 view modes.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-30T23:02:11.142941034Z","created_by":"bob","updated_at":"2026-02-02T17:28:39.816095939Z","closed_at":"2026-02-02T17:28:39.816044362Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design","ux"],"comments":[{"id":28,"issue_id":"bd-d6d","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-eui","title":"highlighting lines and adding comments doesnt work","description":"I can highlight lines, type in a comment. all fine, but it never creates a thread for it, even if I reload the review.","status":"closed","priority":2,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-15T20:36:44.993809991Z","created_by":"bob","updated_at":"2026-02-15T20:50:43.276280054Z","closed_at":"2026-02-15T20:50:43.276248795Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["add-comments"]}
{"id":"bd-fgn","title":"Persist theme selection in user config","description":"Bake in default themes and persist selected theme to /home/bob/.config/.botcrit/ui.json. On startup, load user config to apply saved theme.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T15:06:10.587229810Z","created_by":"bob","updated_at":"2026-01-28T20:05:17.389834305Z","closed_at":"2026-01-28T20:05:17.389807384Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-fia","title":"Improve thread marker glyphs","description":"Replace current thread markers ('o' and '*') with better Unicode or nerd font icons that are visually clearer in the TUI.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-29T03:28:13.239861821Z","created_by":"bob","updated_at":"2026-01-29T16:20:42.598091779Z","closed_at":"2026-01-29T16:20:42.598067904Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-gr4","title":"Default to side-by-side diff when wide","description":"When width permits, use side-by-side diff by default. Make this behavior configurable via user config (depends on config work).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T17:10:01.937104209Z","created_by":"bob","updated_at":"2026-01-30T00:04:15.480521826Z","closed_at":"2026-01-30T00:04:15.480497631Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-irx","title":"Don't show theme name in status bar","description":"Remove the theme name display from the bottom-left of the screen. The theme indicator (e.g. [default-dark]) clutters the status bar and isn't needed since theme selection will be available via the command palette.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:28:13.920760020Z","created_by":"bob","updated_at":"2026-01-30T16:38:19.402559113Z","closed_at":"2026-01-30T16:38:19.402535489Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-j8z","title":"Mouse wheel should scroll sidebar when hovering","description":"When in review detail, mouse wheel scrolling should navigate the sidebar if the cursor is over it; otherwise scroll the diff.\n\nAcceptance:\n- scroll wheel over sidebar moves selection up/down\n- scroll wheel over diff scrolls diff\n- works in full/compact/overlay layouts (and single when sidebar visible)\n\nTesting: open a review, hover sidebar and scroll; hover diff and scroll.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-02-02T04:20:55.237128630Z","created_by":"bob","updated_at":"2026-02-02T04:29:53.340827232Z","closed_at":"2026-02-02T04:29:53.340804419Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-jv4","title":"use U+2026 (…) for truncated strings instead of \"...\"","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-11T20:16:14.368678192Z","created_by":"bob","updated_at":"2026-02-11T20:18:54.757732602Z","closed_at":"2026-02-11T20:18:54.757700832Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design"]}
{"id":"bd-kph","title":"Widen file sidebar by default","description":"Make the file sidebar wider in normal layouts; only compress when space is constrained.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T18:03:51.642477942Z","created_by":"bob","updated_at":"2026-01-28T18:16:25.757303021Z","closed_at":"2026-01-28T18:16:25.757271221Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-l09","title":"--include-diffs returns empty files when review has no threads","description":"## Bug\n\n`crit review <id> --include-diffs --format json` returns `\"files\": []` when a review has zero threads, even though the review has changed files with diffs. This means consumers (like crit-ui) get no file/diff data for uncommented reviews.\n\n## Repro\n\n```bash\n# In /tmp/8o8-crit-demo:\ncrit review cr-13nf --include-diffs --format json --path /tmp/8o8-crit-demo\n# Returns: \"files\": [], \"threads\": []\n\n# But crit diff has the data:\ncrit diff cr-13nf --format json --path /tmp/8o8-crit-demo\n# Returns: \"changed_files\": [\"src/server.rs\"], \"diff\": \"diff --git a/src/server.rs ...\"\n```\n\n## Expected\n\n`--include-diffs` should include diffs for ALL changed files in the review, regardless of whether they have threads. The flag name implies \"include the diffs for this review\", not \"include diffs only for files that have threads\".\n\n## Suggested fix\n\nIn the `review` command handler, when `--include-diffs` is set, populate the `files` array from the same source `crit diff` uses (the git diff between base and target commits). Currently it appears to only populate files that have threads attached.\n\n## Impact\n\ncrit-ui shows \"No content available\" for reviews with no comments, making them unreadable. Workaround: crit-ui could fall back to `crit diff` when files are empty, but the upstream fix is cleaner.","status":"closed","priority":2,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-15T21:55:24.429006783Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-15T21:56:28.145378704Z","closed_at":"2026-02-15T21:56:28.145275841Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-mew","title":"Review list: hide Navigate hint, replace Open/All with Filter Status toggle","description":"Remove 'Navigate j/k' from hotkey bar. Replace 'Open Only o' and 'All a' with 'Filter Status (All) s' that cycles through all/open/closed states.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T19:21:07.771317417Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T19:48:36.064416139Z","closed_at":"2026-02-11T19:48:36.064389198Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":34,"issue_id":"bd-mew","author":"botcrit-ui-dev","text":"Design decided: Remove Navigate j/k. Remove 'Open Only o' and 'All a'. Add 'Status (All) s' that cycles: All -> Open -> Closed -> All. Keep Commands ctrl+p, Select Enter, Quit q.","created_at":"2026-02-11T19:38:11Z"}]}
{"id":"bd-psp","title":"Center view on expanded thread","description":"Expanding a thread should auto-scroll so the thread block is vertically centered in the view.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T18:03:56.343811355Z","created_by":"bob","updated_at":"2026-01-28T20:13:54.592910944Z","closed_at":"2026-01-28T20:13:54.592874897Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-q5l","title":"Right-align comment IDs","description":"Comment blocks should show right-aligned comment IDs in darker text.","status":"closed","priority":2,"issue_type":"design","created_at":"2026-01-28T18:04:01.958454185Z","created_by":"bob","updated_at":"2026-01-28T18:16:27.772606408Z","closed_at":"2026-01-28T18:16:27.772573667Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-r9u","title":"show threads IDs as sub items of files","description":"* file/name-1\n    th-123\n    th-234\n  file/name-2\n    th-345\n\nthis means we'd change how focusing/jumping works now. right now it's focus on files, but we need to make it work for files or threads.\n\ndesign will be in notes/sidebar-tree.txt","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T22:03:29.050101222Z","created_by":"bob","updated_at":"2026-02-02T16:33:20.201402361Z","closed_at":"2026-02-02T16:32:47.896104455Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["design","ux"],"comments":[{"id":29,"issue_id":"bd-r9u","author":"Bob","text":"All child tasks (bd-r9u.1/.2/.3) completed; epic closed.","created_at":"2026-02-02T16:33:20Z"}]}
{"id":"bd-r9u.1","title":"Sidebar tree data model and rendering","description":"Add a tree structure to the sidebar model: files as parent nodes, thread IDs as children. Render with indentation (2-space indent for threads under files). Thread entries show thread_id, status icon, and comment count.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T22:40:57.734076868Z","created_by":"bob","updated_at":"2026-01-31T02:45:31.022955598Z","closed_at":"2026-01-31T02:45:31.022932986Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-r9u.1","depends_on_id":"bd-r9u","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-r9u.2","title":"Sidebar tree focus and navigation","description":"Update focus/navigation to work with the tree structure. j/k moves between files AND threads. Enter on a file expands/collapses its thread list. Enter on a thread jumps to that thread in the diff pane. Maintain current file_index + add thread_index for two-level selection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T22:41:02.865354208Z","created_by":"bob","updated_at":"2026-01-31T03:18:10.381960593Z","closed_at":"2026-01-31T03:18:10.381889059Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-r9u.2","depends_on_id":"bd-r9u","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-r9u.2","depends_on_id":"bd-r9u.1","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-r9u.3","title":"Sidebar tree scroll and selection sync","description":"Sync sidebar selection highlight with diff pane scroll position. When scrolling through the diff, the sidebar should highlight the current file and thread. When navigating threads with n/p in the diff, sidebar selection should follow.\n\nAcceptance criteria:\n- Scrolling the diff pane updates the sidebar highlight to the current file/thread\n- Pressing n/p (next/prev thread) updates the sidebar highlight\n- Selecting a thread in the sidebar scrolls the diff to that thread's position\n- Sidebar auto-scrolls if the highlighted item is off-screen\n\nTesting: Open a review with multiple files and threads. Scroll through the diff and verify sidebar tracks. Use n/p and verify sidebar follows. Click sidebar items and verify diff jumps.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T22:41:07.416730497Z","created_by":"bob","updated_at":"2026-02-03T02:29:59.371047030Z","closed_at":"2026-02-03T02:29:59.371023406Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"dependencies":[{"issue_id":"bd-r9u.3","depends_on_id":"bd-12v","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-r9u.3","depends_on_id":"bd-r9u","type":"parent-child","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-r9u.3","depends_on_id":"bd-r9u.2","type":"blocks","created_at":"2026-02-09T14:08:19Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":30,"issue_id":"bd-r9u.3","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-s73","title":"Sidebar selection sync and jump","description":"Sidebar selection should track the file currently at top of the right-pane stream. Selecting a file in the sidebar should jump scroll to that file’s header.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T16:03:21.377215776Z","created_by":"bob","updated_at":"2026-01-28T16:45:02.163981384Z","closed_at":"2026-01-28T16:45:02.163953061Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-t18","title":"Open file in nvim from TUI","description":"Add keybinding (e) to open the current file in nvim within the same terminal session (like lazygit).","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-28T17:14:44.903763944Z","created_by":"bob","updated_at":"2026-01-30T02:38:09.767604627Z","closed_at":"2026-01-30T02:38:09.767575062Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-u8m","title":"scrolling _up_ to a file in the sidebar doesn't work","description":"when on the sidebar, scrolling down onto a file jumps the view to the file as expected.\nbut scrolling up to a file from below with k does not jump at all.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-13T22:57:47.644571788Z","created_by":"bob","updated_at":"2026-02-13T23:09:46.907082628Z","closed_at":"2026-02-13T23:09:46.907059054Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["sidebar"]}
{"id":"bd-uva","title":"remove cycle theme command","description":"Remove the cycle-theme keybinding/command since theme selection UI now exists.\n\nAcceptance criteria:\n- Cycle theme keybinding is removed\n- Theme select (ctrl+p or similar) still works\n- No dead code left behind\n\nTesting: Build and verify the old keybinding does nothing. Verify theme selection still works.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T22:52:34.881777281Z","created_by":"bob","updated_at":"2026-02-01T19:54:06.700946697Z","closed_at":"2026-02-01T19:54:06.700923614Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"],"comments":[{"id":31,"issue_id":"bd-uva","author":"Bob","text":"Groomed: added acceptance criteria and testing strategy","created_at":"2026-01-31T23:39:51Z"}]}
{"id":"bd-vov","title":"Review list: 2-line review items with state indicators","description":"Make each review line item take 2 lines instead of 1. Render mockups in plain text showing how items should look in different states (open, closed, with threads, etc). Design is exploratory -- expect iteration.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T19:21:03.859483801Z","created_by":"botcrit-ui-dev","updated_at":"2026-02-11T19:48:35.948846248Z","closed_at":"2026-02-11T19:48:35.948817895Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":33,"issue_id":"bd-vov","author":"botcrit-ui-dev","text":"Design decided: Option B style. Line 1: '  cr-xxxx  <title truncated>    N th' (thread count right-aligned, '5 th' format). Line 2: '           [status]  @author -> @reviewer1, @reviewer2'. Reviewers need upstream crit change to list endpoint; for now just show @author. @ prefix on all agent/user names. Variable-length IDs packed into line 1. Open reviews with unresolved: '3/8 th' in warning color.","created_at":"2026-02-11T19:38:03Z"}]}
{"id":"bd-wr2","title":"Evaluate frankentui over opentui_rust","description":"opentui_rust was a stepping-stone port and may not be supported going forward.\nit was used as a basis to create github.com/Dicklesworthstone/frankentui.\n\nI think frankentui is a whole TUI lib. Where opentui is just about rendering, frankentui gives you the app runtime and widgets.\nI think we only care about rendering.\n\nGoals:\n- see if frankentui supports rendering modules that we can use instead of opentui\n- lightly evaluate the app framework and widgets to see if we can customize them to look like the custom style crit-ui uses\n\nThis will be a pretty big task. Advise using /tmp dirs liberally to scaffold and test things.","status":"closed","priority":2,"issue_type":"task","owner":"botcrit-ui-dev","created_at":"2026-02-11T18:56:17.713472172Z","created_by":"bob","updated_at":"2026-02-20T21:21:26.154434322Z","closed_at":"2026-02-20T21:21:26.154415336Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["framework"],"comments":[{"id":37,"issue_id":"bd-wr2","author":"botcrit-ui-dev","text":"## Evaluation: frankentui vs opentui_rust\n\n### What frankentui provides\n- 19-crate workspace: ftui-core (terminal), ftui-render (buffer/diff/presenter), ftui-style (CSS-like themes), ftui-layout (flex/grid), ftui-runtime (Elm-style event loop), ftui-widgets, etc.\n- Same author as opentui_rust (Dicklesworthstone). frankentui is the successor, not a port.\n\n### Rendering kernel (ftui-render)\n- Strictly better than opentui: 16-byte cache-aligned cells, packed RGBA, span-level dirty tracking, explicit BufferDiff, HeadlessTerm for snapshot testing\n- Similar API surface: Buffer + Draw trait with draw_text, fill_rect, draw_border equivalents\n- Separate Presenter with DP cost model for minimal ANSI output\n\n### Migration cost: HIGH\n- **Color type mismatch is the blocker**: opentui uses Rgba{f32,f32,f32,f32} with lerp/luminance/blend_over. frankentui uses PackedRgba (u32). Our theme system + all 23 view files (~600 color locations) would need rewriting.\n- Buffer API is medium effort (similar concepts, different signatures)\n- Renderer → Buffer+Diff+Presenter split requires main.rs restructuring\n- Input/events are low effort (1:1 concept mapping)\n\n### Concerns\n- Requires Rust nightly (edition 2024 + nightly features)\n- Not fully on crates.io yet\n- 19 crates = larger dependency surface + build times\n- API still v0.1.x with daily commits, high breakage risk\n\n### Recommendation: Stay on opentui_rust for now\n- Migration ROI is poor: massive color refactor for incremental rendering gains we don't need\n- Both libs are by same author, rapidly evolving — waiting reduces wasted work\n- If we need headless testing, easier to add it on top of opentui than migrate everything\n- Revisit if opentui_rust is abandoned or frankentui stabilizes (v0.2+)","created_at":"2026-02-12T01:17:11Z"},{"id":40,"issue_id":"bd-wr2","author":"Bob","text":"Reopened: Reopen because some situations changed.","created_at":"2026-02-20T20:51:03Z"},{"id":41,"issue_id":"bd-wr2","author":"Bob","text":"ftui-render is on crates. the top-level docs say nightly but I don't see any hard requirements. opentui_rust is lagging behind andd frankentui is shooting forward","created_at":"2026-02-20T20:51:45Z"},{"id":42,"issue_id":"bd-wr2","author":"Bob","text":"source is at ~/repos/frankentui/crates/ftui-render","created_at":"2026-02-20T20:52:17Z"},{"id":43,"issue_id":"bd-wr2","author":"botcrit-ui-dev","text":"## Re-evaluation update (2026-02-20)\n\nRechecked this with the new context (ftui-render published, possible stable use, opentui_rust lagging).\n\n### What changed since prior conclusion\n- `ftui-render` is now published on crates.io (`0.2.1`).\n- A stable toolchain probe (`rustc 1.93.0`) compiling a minimal `ftui-core + ftui-render` drawing program succeeded.\n- I found no repo-wide `#![feature(...)]` usage in frankentui, so nightly does not currently look like a hard blocker for render-only usage.\n\n### What still blocks a direct swap in botcrit-ui\n- Migration is not drop-in: botcrit-ui currently has a large OpenTUI footprint (~379 references).\n- Biggest mismatch remains color math: we rely on float `Rgba` operations (`lerp`, `blend_over`, luminance-based derivations) across theme/view code, while `ftui-render` is packed-u8 color oriented.\n- Runtime/input integration differs (`Renderer/InputParser` today vs `ftui-core` + `ftui-render` split), so a full swap is still meaningful refactor risk.\n\n### Revised recommendation\n- **Do not do a full migration immediately.**\n- **Do start a phased render-only pilot now** (this is the change from the previous recommendation):\n  1. Add a small rendering facade boundary in botcrit-ui (Color/Style/Buffer/Presenter-ish API).\n  2. Port one constrained screen/path behind a feature flag to `ftui-render` on stable.\n  3. Compare complexity/perf/maintenance; then decide whether to expand migration.\n\nGiven opentui_rust appears to be lagging, this phased path reduces lock-in risk without paying the full rewrite cost up front.","created_at":"2026-02-20T21:14:41Z"},{"id":44,"issue_id":"bd-wr2","author":"botcrit-ui-dev","text":"## Follow-up refinement: color math + migration strategy (2026-02-20)\n\nIncorporating additional check across the broader ftui crates:\n\n- `ftui-render` + `ftui-style` already cover key primitives (`with_opacity`, alpha-over compositing, luminance/contrast/best-text-color).\n- `ftui-style` also has additional blend/lerp logic (mostly table-theme scoped).\n- Richer color-space tools (HSV/OkLab/perceptual interpolation, gradients) exist in `ftui-extras` feature-gated modules.\n- No direct `palette` crate dependency exists in frankentui today.\n\n### Recommendation adjustment\nThis lowers the color-math blocker from hard/high to moderate: color tooling is available, and `palette` can fill gaps cleanly if needed.\n\n### About hard switch risk\nGiven current statement that there are effectively no active end users, **product/user-facing blast radius is low**, which makes a hard cutover more acceptable from a release-risk perspective.\n\nHowever, there is still engineering execution risk (large refactor surface, integration churn, and regression/debug time). So decision should be based on schedule tolerance more than user impact:\n\n1. If priority is fastest path to long-term platform convergence, a hard switch is now a defensible choice.\n2. If priority is predictable delivery and easier rollback, keep phased migration.\n\nI still slightly prefer phased migration for control, but hard switch is now reasonable given low user-risk context.","created_at":"2026-02-20T21:19:24Z"}]}
{"id":"bd-wzd","title":"hide scroll keys from hotkey bar","description":"too many scroll options, they're intended to be guessable, we can just hide them from the hotkey bar (j/k), thread (n/p, doesn't work anyway)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-11T18:46:48.426150637Z","created_by":"bob","updated_at":"2026-02-11T18:48:05.011500839Z","closed_at":"2026-02-11T18:48:05.011482544Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["hotkeys"]}
{"id":"bd-xm5","title":"Review List screen","description":"Implement review list view with open/closed sections, selection, and navigation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T16:15:31.654761532Z","created_by":"bob","updated_at":"2026-01-27T17:13:55.132078321Z","closed_at":"2026-01-27T17:13:55.132050028Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-ybd","title":"Remove status header in review list","description":"Remove the header row showing status (OPEN/CLOSED) in review list; it persists when entering detail view.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T20:38:04.604654277Z","created_by":"bob","updated_at":"2026-01-28T20:47:11.509899657Z","closed_at":"2026-01-28T20:47:11.509876324Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-z0k","title":"adding replies to threads, all apply to first thread in review","description":"working on demo project /tmp/8o8-crit-demo\n\nwhen highlighting _any_ thread and hitting a to add a comment, it previews the very first thread and add comments to that very first thread.","status":"closed","priority":2,"issue_type":"bug","owner":"botcrit-ui-dev","created_at":"2026-02-15T20:35:58.091244241Z","created_by":"bob","updated_at":"2026-02-15T20:50:43.156854324Z","closed_at":"2026-02-15T20:50:43.156828015Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["add-comments"]}
{"id":"bd-z91","title":"Seed-based theme system","description":"Refactor theme system from 30+ explicit colors to 7 seed colors (background, foreground, primary, muted, success, warning, error) with automatic derivation via lerp/blend_over. Keep full Theme struct, add from_seeds() constructor, convert all theme JSONs, support overrides.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T18:17:31.759380067Z","created_by":"bob","updated_at":"2026-01-30T18:31:57.938540824Z","closed_at":"2026-01-30T18:31:57.938465683Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-za0","title":"Sidebar review metadata spacing","description":"Sidebar should show one blank line before the review id block and one blank line after the bookmark/commit info; not visible currently.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T18:45:36.527182789Z","created_by":"bob","updated_at":"2026-01-28T18:50:32.047785315Z","closed_at":"2026-01-28T18:50:32.047750710Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-zel","title":"Toggle diff line wrapping","description":"Add keybinding (w) to toggle line wrapping in diff views. Should apply to unified and side-by-side rendering.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-28T14:52:40.310288454Z","created_by":"bob","updated_at":"2026-01-29T23:59:40.821506206Z","closed_at":"2026-01-29T23:59:40.821476550Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
